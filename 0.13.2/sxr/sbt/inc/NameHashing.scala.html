<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>sbt/inc/NameHashing.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> sbt.inc

<span class="keyword">import</span> xsbti.api.SourceAPI
<span class="keyword">import</span> xsbti.api.Definition
<span class="keyword">import</span> xsbti.api.DefinitionType
<span class="keyword">import</span> xsbti.api.ClassLike
<span class="keyword">import</span> xsbti.api._internalOnly_NameHash
<span class="keyword">import</span> xsbti.api._internalOnly_NameHashes
<span class="keyword">import</span> xsbt.api.Visit

<span class="comment">/**
 * A class that computes hashes for each group of definitions grouped by a simple name.
 *
 * See `nameHashes` method for details.
 */</span>
<span class="keyword">class</span> <a title="class NameHashing extends AnyRef" id="sbt.inc;NameHashing">NameHashing</a> <a href="#sbt.inc;NameHashing" title="sbt.inc.NameHashing" class="delimiter">{</a>

	<span class="keyword">import</span> <a href="#sbt.inc.NameHashing" title="sbt.inc.NameHashing.type">NameHashing</a>._

	<span class="comment">/**
	 * This method takes an API representation and extracts a flat collection of all
	 * definitions contained in that API representation. Then it groups definition
	 * by a simple name. Lastly, it computes a hash sum of all definitions in a single
	 * group.
	 *
	 * NOTE: The hashing sum used for hashing a group of definition is insensitive
	 * to order of definitions.
	 */</span>
	<span class="keyword">def</span> <a title="(source: xsbti.api.SourceAPI)xsbti.api._internalOnly_NameHashes" id="sbt.inc;NameHashing.nameHashes">nameHashes</a><span class="delimiter">(</span><a title="xsbti.api.SourceAPI" id="sbt.inc;NameHashing.nameHashes.source">source</a>: <a href="../../xsbti/api/SourceAPI.java.html#xsbti.api;SourceAPI" title="xsbti.api.SourceAPI">SourceAPI</a><span class="delimiter">)</span>: <a href="../../xsbti/api/_internalOnly_NameHashes.java.html#xsbti.api;_internalOnly_NameHashes" title="xsbti.api._internalOnly_NameHashes">_internalOnly_NameHashes</a> = <span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="Iterable[sbt.inc.NameHashing.LocatedDefinition]" id="sbt.inc;NameHashing.nameHashes.apiPublicDefs">apiPublicDefs</a> = <a href="#sbt.inc;NameHashing.publicDefs" title="(source: xsbti.api.SourceAPI)Iterable[sbt.inc.NameHashing.LocatedDefinition]">publicDefs</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing.nameHashes.source" title="xsbti.api.SourceAPI">source</a><span class="delimiter">)</span>
		<span class="keyword">val</span> <a href="#sbt.inc;NameHashing.nameHashes.regularDefs" title="(Iterable[sbt.inc.NameHashing.LocatedDefinition], Iterable[sbt.inc.NameHashing.LocatedDefinition])" class="delimiter">(</a><a href="#sbt.inc;NameHashing.nameHashes.x$1" title="Iterable[sbt.inc.NameHashing.LocatedDefinition]" id="sbt.inc;NameHashing.nameHashes.regularDefs">regularDefs</a>, <a href="#sbt.inc;NameHashing.nameHashes.x$1" title="Iterable[sbt.inc.NameHashing.LocatedDefinition]" id="sbt.inc;NameHashing.nameHashes.implicitDefs">implicitDefs</a><span class="delimiter">)</span> = <a href="#sbt.inc;NameHashing.nameHashes.apiPublicDefs" title="Iterable[sbt.inc.NameHashing.LocatedDefinition]">apiPublicDefs</a>.<span title="(p: sbt.inc.NameHashing.LocatedDefinition =&gt; Boolean)(Iterable[sbt.inc.NameHashing.LocatedDefinition], Iterable[sbt.inc.NameHashing.LocatedDefinition])">partition</span><span title="(Iterable[sbt.inc.NameHashing.LocatedDefinition], Iterable[sbt.inc.NameHashing.LocatedDefinition]) @unchecked" class="delimiter">(</span><a title="sbt.inc.NameHashing.LocatedDefinition" id="sbt.inc;NameHashing.nameHashes.x$1.$anonfun.locDef">locDef</a> =&gt; <span title="=&gt; Boolean">!</span><a href="#sbt.inc;NameHashing.nameHashes.x$1.$anonfun.locDef" title="sbt.inc.NameHashing.LocatedDefinition">locDef</a>.<a href="#sbt.inc.NameHashing;LocatedDefinition.definition" title="=&gt; xsbti.api.Definition">definition</a>.<a href="../../xsbti/api/Definition.java.html#xsbti.api;Definition.modifiers(f3f3902220)" title="()xsbti.api.Modifiers">modifiers</a>.<a href="../../xsbti/api/Modifiers.java.html#xsbti.api;Modifiers.isImplicit" title="()Boolean">isImplicit</a><span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="Iterable[xsbti.api._internalOnly_NameHash]" id="sbt.inc;NameHashing.nameHashes.regularNameHashes">regularNameHashes</a> = <a href="#sbt.inc;NameHashing.nameHashesForLocatedDefinitions" title="(locatedDefs: Iterable[sbt.inc.NameHashing.LocatedDefinition])Iterable[xsbti.api._internalOnly_NameHash]">nameHashesForLocatedDefinitions</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing.nameHashes.regularDefs" title="Iterable[sbt.inc.NameHashing.LocatedDefinition]">regularDefs</a><span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="Iterable[xsbti.api._internalOnly_NameHash]" id="sbt.inc;NameHashing.nameHashes.implicitNameHashes">implicitNameHashes</a> = <a href="#sbt.inc;NameHashing.nameHashesForLocatedDefinitions" title="(locatedDefs: Iterable[sbt.inc.NameHashing.LocatedDefinition])Iterable[xsbti.api._internalOnly_NameHash]">nameHashesForLocatedDefinitions</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing.nameHashes.implicitDefs" title="Iterable[sbt.inc.NameHashing.LocatedDefinition]">implicitDefs</a><span class="delimiter">)</span>
		<span title="xsbti.api._internalOnly_NameHashes" class="keyword">new</span> <a href="../../xsbti/api/_internalOnly_NameHashes.java.html#xsbti.api;_internalOnly_NameHashes" title="xsbti.api._internalOnly_NameHashes">_internalOnly_NameHashes</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing.nameHashes.regularNameHashes" title="Iterable[xsbti.api._internalOnly_NameHash]">regularNameHashes</a>.<span title="(implicit evidence$1: scala.reflect.ClassTag[xsbti.api._internalOnly_NameHash])Array[xsbti.api._internalOnly_NameHash]">toArray</span>, <a href="#sbt.inc;NameHashing.nameHashes.implicitNameHashes" title="Iterable[xsbti.api._internalOnly_NameHash]">implicitNameHashes</a>.<span title="(implicit evidence$1: scala.reflect.ClassTag[xsbti.api._internalOnly_NameHash])Array[xsbti.api._internalOnly_NameHash]">toArray</span><span class="delimiter">)</span>
	<span class="delimiter">}</span>

	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(locatedDefs: Iterable[sbt.inc.NameHashing.LocatedDefinition])Iterable[xsbti.api._internalOnly_NameHash]" id="sbt.inc;NameHashing.nameHashesForLocatedDefinitions">nameHashesForLocatedDefinitions</a><span class="delimiter">(</span><a title="Iterable[sbt.inc.NameHashing.LocatedDefinition]" id="sbt.inc;NameHashing.nameHashesForLocatedDefinitions.locatedDefs">locatedDefs</a>: <span title="Iterable[sbt.inc.NameHashing.LocatedDefinition]">Iterable</span><span class="delimiter">[</span>LocatedDefinition<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Iterable[xsbti.api._internalOnly_NameHash]">Iterable</span><span class="delimiter">[</span>_internalOnly_NameHash<span class="delimiter">]</span> = <span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Map[String,Iterable[sbt.inc.NameHashing.LocatedDefinition]]" id="sbt.inc;NameHashing.nameHashesForLocatedDefinitions.groupedBySimpleName">groupedBySimpleName</a> = <a href="#sbt.inc;NameHashing.nameHashesForLocatedDefinitions.locatedDefs" title="Iterable[sbt.inc.NameHashing.LocatedDefinition]">locatedDefs</a>.<span title="(f: sbt.inc.NameHashing.LocatedDefinition =&gt; String)scala.collection.immutable.Map[String,Iterable[sbt.inc.NameHashing.LocatedDefinition]]">groupBy</span><span class="delimiter">(</span><a title="sbt.inc.NameHashing.LocatedDefinition" id="sbt.inc;NameHashing.nameHashesForLocatedDefinitions.groupedBySimpleName.$anonfun.locatedDef">locatedDef</a> =&gt; <a href="#sbt.inc;NameHashing.localName" title="(name: String)String">localName</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing.nameHashesForLocatedDefinitions.groupedBySimpleName.$anonfun.locatedDef" title="sbt.inc.NameHashing.LocatedDefinition">locatedDef</a>.<a href="#sbt.inc.NameHashing;LocatedDefinition.definition" title="=&gt; xsbti.api.Definition">definition</a>.<a href="../../xsbti/api/Definition.java.html#xsbti.api;Definition.name(612e557918)" title="()String">name</a><span class="delimiter">)</span><span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Map[String,Int]" id="sbt.inc;NameHashing.nameHashesForLocatedDefinitions.hashes">hashes</a> = <a href="#sbt.inc;NameHashing.nameHashesForLocatedDefinitions.groupedBySimpleName" title="scala.collection.immutable.Map[String,Iterable[sbt.inc.NameHashing.LocatedDefinition]]">groupedBySimpleName</a>.<span title="(f: Iterable[sbt.inc.NameHashing.LocatedDefinition] =&gt; Int)scala.collection.immutable.Map[String,Int]">mapValues</span><span class="delimiter">(</span><a href="#sbt.inc;NameHashing.hashLocatedDefinitions" title="(locatedDefs: Iterable[sbt.inc.NameHashing.LocatedDefinition])Int">hashLocatedDefinitions</a><span class="delimiter">)</span>
		<a href="#sbt.inc;NameHashing.nameHashesForLocatedDefinitions.hashes" title="scala.collection.immutable.Map[String,Int]">hashes</a>.<span title="=&gt; Iterable[(String, Int)]">toIterable</span>.<span title="(f: ((String, Int)) =&gt; xsbti.api._internalOnly_NameHash)(implicit bf: scala.collection.generic.CanBuildFrom[Iterable[(String, Int)],xsbti.api._internalOnly_NameHash,Iterable[xsbti.api._internalOnly_NameHash]])Iterable[xsbti.api._internalOnly_NameHash]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Iterable.Coll,xsbti.api._internalOnly_NameHash,Iterable[xsbti.api._internalOnly_NameHash]]" class="delimiter">(</span><a href="#sbt.inc;NameHashing.nameHashesForLocatedDefinitions.$anonfun.x0$1" title="xsbti.api._internalOnly_NameHash" class="delimiter">{</a> <span class="keyword">case</span> <span class="delimiter">(</span><a title="String" id="sbt.inc;NameHashing.nameHashesForLocatedDefinitions.$anonfun.name">name</a>: <span title="String">String</span>, <a title="Int" id="sbt.inc;NameHashing.nameHashesForLocatedDefinitions.$anonfun.hash">hash</a>: <span title="Int">Int</span><span class="delimiter">)</span> =&gt; <span title="xsbti.api._internalOnly_NameHash" class="keyword">new</span> <a href="../../xsbti/api/_internalOnly_NameHash.java.html#xsbti.api;_internalOnly_NameHash" title="xsbti.api._internalOnly_NameHash">_internalOnly_NameHash</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing.nameHashesForLocatedDefinitions.$anonfun.name" title="String">name</a>, <a href="#sbt.inc;NameHashing.nameHashesForLocatedDefinitions.$anonfun.hash" title="Int">hash</a><span class="delimiter">)</span> <span class="delimiter">}</span><span class="delimiter">)</span>
	<span class="delimiter">}</span>

	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(locatedDefs: Iterable[sbt.inc.NameHashing.LocatedDefinition])Int" id="sbt.inc;NameHashing.hashLocatedDefinitions">hashLocatedDefinitions</a><span class="delimiter">(</span><a title="Iterable[sbt.inc.NameHashing.LocatedDefinition]" id="sbt.inc;NameHashing.hashLocatedDefinitions.locatedDefs">locatedDefs</a>: <span title="Iterable[sbt.inc.NameHashing.LocatedDefinition]">Iterable</span><span class="delimiter">[</span>LocatedDefinition<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="Seq[(xsbti.api.Definition, Int)]" id="sbt.inc;NameHashing.hashLocatedDefinitions.defsWithExtraHashes">defsWithExtraHashes</a> = <a href="#sbt.inc;NameHashing.hashLocatedDefinitions.locatedDefs" title="Iterable[sbt.inc.NameHashing.LocatedDefinition]">locatedDefs</a>.<span title="=&gt; Seq[sbt.inc.NameHashing.LocatedDefinition]">toSeq</span>.<span title="(f: sbt.inc.NameHashing.LocatedDefinition =&gt; (xsbti.api.Definition, Int))(implicit bf: scala.collection.generic.CanBuildFrom[Seq[sbt.inc.NameHashing.LocatedDefinition],(xsbti.api.Definition, Int),Seq[(xsbti.api.Definition, Int)]])Seq[(xsbti.api.Definition, Int)]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,(xsbti.api.Definition, Int),Seq[(xsbti.api.Definition, Int)]]" class="delimiter">(</span><a title="sbt.inc.NameHashing.LocatedDefinition" id="sbt.inc;NameHashing.hashLocatedDefinitions.defsWithExtraHashes.$anonfun.ld">ld</a> =&gt; <a href="#sbt.inc;NameHashing.hashLocatedDefinitions.defsWithExtraHashes.$anonfun.ld" title="sbt.inc.NameHashing.LocatedDefinition">ld</a>.<a href="#sbt.inc.NameHashing;LocatedDefinition.definition" title="(x: xsbti.api.Definition)ArrowAssoc[xsbti.api.Definition]">definition</a> <span title="(y: Int)(xsbti.api.Definition, Int)">-&gt;</span> <a href="#sbt.inc;NameHashing.hashLocatedDefinitions.defsWithExtraHashes.$anonfun.ld" title="sbt.inc.NameHashing.LocatedDefinition">ld</a>.<a href="#sbt.inc.NameHashing;LocatedDefinition.location" title="=&gt; sbt.inc.NameHashing.Location">location</a>.<span title="()Int">hashCode</span><span class="delimiter">)</span>
		xsbt.api.<a href="../../xsbt/api/HashAPI.scala.html#xsbt.api.HashAPI" title="xsbt.api.HashAPI.type">HashAPI</a>.<a href="../../xsbt/api/HashAPI.scala.html#xsbt.api.HashAPI.hashDefinitionsWithExtraHashes" title="(ds: Seq[(xsbti.api.Definition, xsbt.api.HashAPI.Hash)])xsbt.api.HashAPI.Hash">hashDefinitionsWithExtraHashes</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing.hashLocatedDefinitions.defsWithExtraHashes" title="Seq[(xsbti.api.Definition, Int)]">defsWithExtraHashes</a><span class="delimiter">)</span>
	<span class="delimiter">}</span>

	<span class="comment">/**
	 * A visitor that visits given API object and extracts all nested public
	 * definitions it finds. The extracted definitions have Location attached
	 * to them which identifies API object's location.
	 *
	 * The returned location is basically a path to a definition that contains
	 * the located definition. For example, if we have:
	 *
	 * object Foo {
	 *   class Bar { def abc: Int }
	 * }
	 *
	 * then location of `abc` is Seq((TermName, Foo), (TypeName, Bar))
	 */</span>
	<span class="keyword">private</span> <span class="keyword">class</span> <a title="class ExtractPublicDefinitions extends xsbt.api.Visit" id="sbt.inc;NameHashing;ExtractPublicDefinitions">ExtractPublicDefinitions</a> <a href="#sbt.inc;NameHashing;ExtractPublicDefinitions" title="NameHashing.this.ExtractPublicDefinitions" class="keyword">extends</a> <a href="../../xsbt/api/Visit.scala.html#xsbt.api;Visit" title="xsbt.api.Visit">Visit</a> <span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="scala.collection.mutable.Buffer[sbt.inc.NameHashing.LocatedDefinition]" id="sbt.inc;NameHashing;ExtractPublicDefinitions.locatedDefs">locatedDefs</a> = scala.collection.mutable.<span title="[A](elems: A*)scala.collection.mutable.Buffer[A]">Buffer</span><span title="(elems: sbt.inc.NameHashing.LocatedDefinition*)scala.collection.mutable.Buffer[sbt.inc.NameHashing.LocatedDefinition]" class="delimiter">[</span><a href="#sbt.inc.NameHashing.LocatedDefinition.readResolve" title="sbt.inc.NameHashing.LocatedDefinition">LocatedDefinition</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
		<span class="keyword">private</span> <span class="keyword">var</span> <a title="sbt.inc.NameHashing.Location" id="sbt.inc;NameHashing;ExtractPublicDefinitions.currentLocation_=">currentLocation</a>: <a href="#sbt.inc.NameHashing;Location" title="sbt.inc.NameHashing.Location">Location</a> = <a href="#sbt.inc.NameHashing;Location" title="(selectors: sbt.inc.NameHashing.Selector*)sbt.inc.NameHashing.Location">Location</a><span class="delimiter">(</span><span class="delimiter">)</span>
		<span class="keyword">override</span> <span class="keyword">def</span> <a title="(s: xsbti.api.SourceAPI)Unit" id="sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI">visitAPI</a><span class="delimiter">(</span><a title="xsbti.api.SourceAPI" id="sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI.s">s</a>: <a href="../../xsbti/api/SourceAPI.java.html#xsbti.api;SourceAPI" title="xsbti.api.SourceAPI">SourceAPI</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
			<a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI.s" title="xsbti.api.SourceAPI">s</a>.<a href="../../xsbti/api/SourceAPI.java.html#xsbti.api;SourceAPI.packages(824c01b20b)" title="(xs: Array[xsbti.api.Package])scala.collection.mutable.ArrayOps[xsbti.api.Package]">packages</a> <span title="(f: xsbti.api.Package =&gt; Unit)Unit">foreach</span> <a href="../../xsbt/api/Visit.scala.html#xsbt.api;Visit.visitPackage" title="(p: xsbti.api.Package)Unit">visitPackage</a>
			<a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI.s" title="xsbti.api.SourceAPI">s</a>.<a href="../../xsbti/api/SourceAPI.java.html#xsbti.api;SourceAPI.definitions(5eead1c2be)" title="(xs: Array[xsbti.api.Definition])scala.collection.mutable.ArrayOps[xsbti.api.Definition]">definitions</a> <span title="(f: xsbti.api.Definition =&gt; Unit)Unit">foreach</span> <a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI.$anonfun.x0$2" title="Unit" class="delimiter">{</a> <span class="keyword">case</span> <a title="xsbti.api.ClassLike" id="sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI.$anonfun.topLevelDef">topLevelDef</a>: <a href="../../xsbti/api/ClassLike.java.html#xsbti.api;ClassLike" title="xsbti.api.ClassLike">ClassLike</a> =&gt;
				<span class="keyword">val</span> <a title="String" id="sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI.$anonfun.packageName">packageName</a> = <span class="delimiter">{</span>
					<span class="keyword">val</span> <a title="String" id="sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI.$anonfun.packageName.fullName">fullName</a> = <a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI.$anonfun.topLevelDef" title="xsbti.api.ClassLike">topLevelDef</a>.<a href="../../xsbti/api/Definition.java.html#xsbti.api;Definition.name(612e557918)" title="()String">name</a><span class="delimiter">(</span><span class="delimiter">)</span>
					<span class="keyword">val</span> <a title="Int" id="sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI.$anonfun.packageName.lastDotIndex">lastDotIndex</a> = <a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI.$anonfun.packageName.fullName" title="String">fullName</a>.<span title="(x$1: Int)Int">lastIndexOf</span><span class="delimiter">(</span><span title="Int(46)" class="char">'.'</span><span class="delimiter">)</span>
					<span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI.$anonfun.packageName.lastDotIndex" title="Int">lastDotIndex</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span> <span class="keyword">else</span> <a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI.$anonfun.packageName.fullName" title="String">fullName</a>.<span title="(x$1: Int, x$2: Int)String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI.$anonfun.packageName.lastDotIndex" title="Int">lastDotIndex</a><span title="(x: Int)Int">-</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
				<span class="delimiter">}</span>
				<a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.currentLocation_=" title="(x$1: sbt.inc.NameHashing.Location)Unit">currentLocation</a> = <a href="#sbt.inc;NameHashing.packageAsLocation" title="(pkg: String)sbt.inc.NameHashing.Location">packageAsLocation</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI.$anonfun.packageName" title="String">packageName</a><span class="delimiter">)</span>
				<a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitDefinition" title="(d: xsbti.api.Definition)Unit">visitDefinition</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI.$anonfun.topLevelDef" title="xsbti.api.ClassLike">topLevelDef</a><span class="delimiter">)</span>
			<span class="delimiter">}</span>
		<span class="delimiter">}</span>
		<span class="keyword">override</span> <span class="keyword">def</span> <a title="(d: xsbti.api.Definition)Unit" id="sbt.inc;NameHashing;ExtractPublicDefinitions.visitDefinition">visitDefinition</a><span class="delimiter">(</span><a title="xsbti.api.Definition" id="sbt.inc;NameHashing;ExtractPublicDefinitions.visitDefinition.d">d</a>: <a href="../../xsbti/api/Definition.java.html#xsbti.api;Definition" title="xsbti.api.Definition">Definition</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
			<span class="keyword">val</span> <a title="sbt.inc.NameHashing.LocatedDefinition" id="sbt.inc;NameHashing;ExtractPublicDefinitions.visitDefinition.locatedDef">locatedDef</a> = <a href="#sbt.inc.NameHashing.LocatedDefinition.readResolve" title="(location: sbt.inc.NameHashing.Location, definition: xsbti.api.Definition)sbt.inc.NameHashing.LocatedDefinition">LocatedDefinition</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.currentLocation_=" title="=&gt; sbt.inc.NameHashing.Location">currentLocation</a>, <a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitDefinition.d" title="xsbti.api.Definition">d</a><span class="delimiter">)</span>
			<a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.locatedDefs" title="=&gt; scala.collection.mutable.Buffer[sbt.inc.NameHashing.LocatedDefinition]">locatedDefs</a> <span title="(elem: sbt.inc.NameHashing.LocatedDefinition)ExtractPublicDefinitions.this.locatedDefs.type">+=</span> <a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitDefinition.locatedDef" title="sbt.inc.NameHashing.LocatedDefinition">locatedDef</a>
			<a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitDefinition.d" title="xsbti.api.Definition">d</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
				<span class="keyword">case</span> <a title="xsbti.api.ClassLike" id="sbt.inc;NameHashing;ExtractPublicDefinitions.visitDefinition.cl">cl</a>: xsbti.api.<a href="../../xsbti/api/ClassLike.java.html#xsbti.api;ClassLike" title="xsbti.api.ClassLike">ClassLike</a> =&gt;
					<span class="keyword">val</span> <a title="sbt.inc.NameHashing.Location" id="sbt.inc;NameHashing;ExtractPublicDefinitions.visitDefinition.savedLocation">savedLocation</a> = <a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.currentLocation_=" title="=&gt; sbt.inc.NameHashing.Location">currentLocation</a>
					<a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.currentLocation_=" title="(x$1: sbt.inc.NameHashing.Location)Unit">currentLocation</a> = <a href="#sbt.inc;NameHashing.classLikeAsLocation" title="(prefix: sbt.inc.NameHashing.Location, cl: xsbti.api.ClassLike)sbt.inc.NameHashing.Location">classLikeAsLocation</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.currentLocation_=" title="=&gt; sbt.inc.NameHashing.Location">currentLocation</a>, <a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitDefinition.cl" title="xsbti.api.ClassLike">cl</a><span class="delimiter">)</span>
					<a href="#sbt.inc;NameHashing;ExtractPublicDefinitions" title="NameHashing.this.ExtractPublicDefinitions" class="keyword">super</a>.<a href="../../xsbt/api/Visit.scala.html#xsbt.api;Visit.visitDefinition" title="(d: xsbti.api.Definition)Unit">visitDefinition</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitDefinition.d" title="xsbti.api.Definition">d</a><span class="delimiter">)</span>
					<a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.currentLocation_=" title="(x$1: sbt.inc.NameHashing.Location)Unit">currentLocation</a> = <a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitDefinition.savedLocation" title="sbt.inc.NameHashing.Location">savedLocation</a>
				<span class="keyword">case</span> _ =&gt;
					<a href="#sbt.inc;NameHashing;ExtractPublicDefinitions" title="NameHashing.this.ExtractPublicDefinitions" class="keyword">super</a>.<a href="../../xsbt/api/Visit.scala.html#xsbt.api;Visit.visitDefinition" title="(d: xsbti.api.Definition)Unit">visitDefinition</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitDefinition.d" title="xsbti.api.Definition">d</a><span class="delimiter">)</span>
			<span class="delimiter">}</span>
		<span class="delimiter">}</span>
	<span class="delimiter">}</span>

	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(source: xsbti.api.SourceAPI)Iterable[sbt.inc.NameHashing.LocatedDefinition]" id="sbt.inc;NameHashing.publicDefs">publicDefs</a><span class="delimiter">(</span><a title="xsbti.api.SourceAPI" id="sbt.inc;NameHashing.publicDefs.source">source</a>: <a href="../../xsbti/api/SourceAPI.java.html#xsbti.api;SourceAPI" title="xsbti.api.SourceAPI">SourceAPI</a><span class="delimiter">)</span>: <span title="Iterable[sbt.inc.NameHashing.LocatedDefinition]">Iterable</span><span class="delimiter">[</span>LocatedDefinition<span class="delimiter">]</span> = <span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="NameHashing.this.ExtractPublicDefinitions" id="sbt.inc;NameHashing.publicDefs.visitor">visitor</a> = <span title="NameHashing.this.ExtractPublicDefinitions" class="keyword">new</span> <a href="#sbt.inc;NameHashing;ExtractPublicDefinitions" title="NameHashing.this.ExtractPublicDefinitions">ExtractPublicDefinitions</a>
		<a href="#sbt.inc;NameHashing.publicDefs.visitor" title="NameHashing.this.ExtractPublicDefinitions">visitor</a>.<a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.visitAPI" title="(s: xsbti.api.SourceAPI)Unit">visitAPI</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing.publicDefs.source" title="xsbti.api.SourceAPI">source</a><span class="delimiter">)</span>
		<a href="#sbt.inc;NameHashing.publicDefs.visitor" title="NameHashing.this.ExtractPublicDefinitions">visitor</a>.<a href="#sbt.inc;NameHashing;ExtractPublicDefinitions.locatedDefs" title="=&gt; scala.collection.mutable.Buffer[sbt.inc.NameHashing.LocatedDefinition]">locatedDefs</a>
	<span class="delimiter">}</span>

	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(name: String)String" id="sbt.inc;NameHashing.localName">localName</a><span class="delimiter">(</span><a title="String" id="sbt.inc;NameHashing.localName.name">name</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
		<span class="comment">// when there's no dot in name `lastIndexOf` returns -1 so we handle</span>
		<span class="comment">// that case properly</span>
		<span class="keyword">val</span> <a title="Int" id="sbt.inc;NameHashing.localName.index">index</a> = <a href="#sbt.inc;NameHashing.localName.name" title="String">name</a>.<span title="(x$1: Int)Int">lastIndexOf</span><span class="delimiter">(</span><span title="Int(46)" class="char">'.'</span><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
		<a href="#sbt.inc;NameHashing.localName.name" title="String">name</a>.<span title="(x$1: Int)String">substring</span><span class="delimiter">(</span><a href="#sbt.inc;NameHashing.localName.index" title="Int">index</a><span class="delimiter">)</span>
	<span class="delimiter">}</span>

	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(pkg: String)sbt.inc.NameHashing.Location" id="sbt.inc;NameHashing.packageAsLocation">packageAsLocation</a><span class="delimiter">(</span><a title="String" id="sbt.inc;NameHashing.packageAsLocation.pkg">pkg</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="#sbt.inc.NameHashing;Location" title="sbt.inc.NameHashing.Location">Location</a> = <span title="sbt.inc.NameHashing.Location" class="keyword">if</span> <span class="delimiter">(</span><a href="#sbt.inc;NameHashing.packageAsLocation.pkg" title="String">pkg</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="Seq[sbt.inc.NameHashing.Selector]" id="sbt.inc;NameHashing.packageAsLocation.selectors">selectors</a> = <a href="#sbt.inc;NameHashing.packageAsLocation.pkg" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">pkg</a>.<span title="(separator: Char)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><span title="Char('.')" class="char">'.'</span><span class="delimiter">)</span>.<span title="(f: String =&gt; sbt.inc.NameHashing.Selector)(implicit bf: scala.collection.generic.CanBuildFrom[Array[String],sbt.inc.NameHashing.Selector,Array[sbt.inc.NameHashing.Selector]])Array[sbt.inc.NameHashing.Selector]">map</span><span title="(xs: Array[sbt.inc.NameHashing.Selector])scala.collection.mutable.ArrayOps[sbt.inc.NameHashing.Selector]" class="delimiter">(</span><a title="String" id="sbt.inc;NameHashing.packageAsLocation.selectors.$anonfun.name">name</a> =&gt; <a href="#sbt.inc.NameHashing.Selector.readResolve" title="(name: String, nameType: sbt.inc.NameHashing.NameType)sbt.inc.NameHashing.Selector">Selector</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing.packageAsLocation.selectors.$anonfun.name" title="String">name</a>, <a href="#sbt.inc.NameHashing.TermName.readResolve" title="sbt.inc.NameHashing.TermName.type">TermName</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; Seq[sbt.inc.NameHashing.Selector]">toSeq</span>
		<a href="#sbt.inc.NameHashing;Location" title="(selectors: sbt.inc.NameHashing.Selector*)sbt.inc.NameHashing.Location">Location</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing.packageAsLocation.selectors" title="Seq[sbt.inc.NameHashing.Selector]">selectors</a>: _*<span class="delimiter">)</span>
	<span class="delimiter">}</span> <span class="keyword">else</span> <a href="#sbt.inc.NameHashing.Location.readResolve" title="sbt.inc.NameHashing.Location.type">Location</a>.<a href="#sbt.inc.NameHashing.Location.Empty" title="=&gt; sbt.inc.NameHashing.Location">Empty</a>

	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(prefix: sbt.inc.NameHashing.Location, cl: xsbti.api.ClassLike)sbt.inc.NameHashing.Location" id="sbt.inc;NameHashing.classLikeAsLocation">classLikeAsLocation</a><span class="delimiter">(</span><a title="sbt.inc.NameHashing.Location" id="sbt.inc;NameHashing.classLikeAsLocation.prefix">prefix</a>: <a href="#sbt.inc.NameHashing;Location" title="sbt.inc.NameHashing.Location">Location</a>, <a title="xsbti.api.ClassLike" id="sbt.inc;NameHashing.classLikeAsLocation.cl">cl</a>: <a href="../../xsbti/api/ClassLike.java.html#xsbti.api;ClassLike" title="xsbti.api.ClassLike">ClassLike</a><span class="delimiter">)</span>: <a href="#sbt.inc.NameHashing;Location" title="sbt.inc.NameHashing.Location">Location</a> = <span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="sbt.inc.NameHashing.Selector" id="sbt.inc;NameHashing.classLikeAsLocation.selector">selector</a> = <span class="delimiter">{</span>
			<span class="keyword">val</span> <a title="sbt.inc.NameHashing.NameType" id="sbt.inc;NameHashing.classLikeAsLocation.selector.clNameType">clNameType</a> = <a href="#sbt.inc.NameHashing.NameType.apply" title="(dt: xsbti.api.DefinitionType)sbt.inc.NameHashing.NameType">NameType</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing.classLikeAsLocation.cl" title="xsbti.api.ClassLike">cl</a>.<a href="../../xsbti/api/ClassLike.java.html#xsbti.api;ClassLike.definitionType(387d9c74a1)" title="()xsbti.api.DefinitionType">definitionType</a><span class="delimiter">)</span>
			<a href="#sbt.inc.NameHashing.Selector.readResolve" title="(name: String, nameType: sbt.inc.NameHashing.NameType)sbt.inc.NameHashing.Selector">Selector</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing.localName" title="(name: String)String">localName</a><span class="delimiter">(</span><a href="#sbt.inc;NameHashing.classLikeAsLocation.cl" title="xsbti.api.ClassLike">cl</a>.<a href="../../xsbti/api/Definition.java.html#xsbti.api;Definition.name(612e557918)" title="()String">name</a><span class="delimiter">)</span>, <a href="#sbt.inc;NameHashing.classLikeAsLocation.selector.clNameType" title="sbt.inc.NameHashing.NameType">clNameType</a><span class="delimiter">)</span>
		<span class="delimiter">}</span>
		<a href="#sbt.inc.NameHashing;Location" title="(selectors: sbt.inc.NameHashing.Selector*)sbt.inc.NameHashing.Location">Location</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#sbt.inc;NameHashing.classLikeAsLocation.prefix" title="sbt.inc.NameHashing.Location">prefix</a>.<a href="#sbt.inc.NameHashing;Location.selectors" title="=&gt; sbt.inc.NameHashing.Selector*">selectors</a> <span title="(elem: sbt.inc.NameHashing.Selector)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[sbt.inc.NameHashing.Selector],sbt.inc.NameHashing.Selector,Seq[sbt.inc.NameHashing.Selector]])Seq[sbt.inc.NameHashing.Selector]">:+</span> <a href="#sbt.inc;NameHashing.classLikeAsLocation.selector" title="sbt.inc.NameHashing.Selector">selector</a><span class="delimiter">)</span>: _*<span class="delimiter">)</span>
	<span class="delimiter">}</span>
<span class="delimiter">}</span>

<span title="AnyRef" class="keyword">object</span> <a title="sbt.inc.NameHashing.type" id="sbt.inc.NameHashing">NameHashing</a> <a href="#sbt.inc.NameHashing" title="sbt.inc.NameHashing.type" class="delimiter">{</a>
	<span class="keyword">private</span> <span class="keyword">case class</span> <a title="class LocatedDefinition extends AnyRef with Product with Serializable" id="sbt.inc.NameHashing.LocatedDefinition.readResolve">LocatedDefinition</a><a href="#sbt.inc.NameHashing.LocatedDefinition.readResolve" title="Product" class="delimiter">(</a><a title="sbt.inc.NameHashing.Location" id="sbt.inc.NameHashing;LocatedDefinition.location">location</a>: <a href="#sbt.inc.NameHashing;Location" title="sbt.inc.NameHashing.Location">Location</a>, <a title="xsbti.api.Definition" id="sbt.inc.NameHashing;LocatedDefinition.definition">definition</a>: <a href="../../xsbti/api/Definition.java.html#xsbti.api;Definition" title="xsbti.api.Definition">Definition</a><span class="delimiter">)</span>
	<span class="comment">/**
	 * Location is expressed as sequence of annotated names. The annotation denotes
	 * a type of a name, i.e. whether it's a term name or type name.
	 *
	 * Using Scala compiler terminology, location is defined as a sequence of member
	 * selections that uniquely identify a given Symbol.
	 */</span>
	<span class="keyword">private</span> <span class="keyword">case class</span> <a href="#sbt.inc.NameHashing;Location.productElement.x$1" title="class Location extends AnyRef with Product with Serializable" id="sbt.inc.NameHashing;Location">Location</a><a href="#sbt.inc.NameHashing;Location" title="Product" class="delimiter">(</a><a title="sbt.inc.NameHashing.Selector*" id="sbt.inc.NameHashing;Location.selectors">selectors</a>: <span title="sbt.inc.NameHashing.Selector*">Selector</span>*<span class="delimiter">)</span>
	<span class="keyword">private</span> <span class="keyword">object</span> <a title="sbt.inc.NameHashing.Location.type" id="sbt.inc.NameHashing.Location.readResolve">Location</a> <a href="#sbt.inc.NameHashing.Location.readResolve" title="sbt.inc.NameHashing.Location.type" class="delimiter">{</a>
		<span class="keyword">val</span> <a title="sbt.inc.NameHashing.Location" id="sbt.inc.NameHashing.Location.Empty">Empty</a> = <a href="#sbt.inc.NameHashing;Location" title="(selectors: sbt.inc.NameHashing.Selector*)sbt.inc.NameHashing.Location">Location</a><span class="delimiter">(</span><span title="scala.collection.Seq.type">Seq</span>.<span title="Seq[Nothing]">empty</span>: _*<span class="delimiter">)</span>
	<span class="delimiter">}</span>
	<span class="keyword">private</span> <span class="keyword">case class</span> <a title="class Selector extends AnyRef with Product with Serializable" id="sbt.inc.NameHashing.Selector.readResolve">Selector</a><a href="#sbt.inc.NameHashing.Selector.readResolve" title="Product" class="delimiter">(</a><a title="String" id="sbt.inc.NameHashing;Selector.name">name</a>: <span title="String">String</span>, <a title="sbt.inc.NameHashing.NameType" id="sbt.inc.NameHashing;Selector.nameType">nameType</a>: <a href="#sbt.inc.NameHashing;NameType" title="sbt.inc.NameHashing.NameType">NameType</a><span class="delimiter">)</span>
	<span class="keyword">private</span> <span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait NameType extends AnyRef" id="sbt.inc.NameHashing;NameType">NameType</a>
	<span class="keyword">private</span> <span class="keyword">object</span> <a title="sbt.inc.NameHashing.NameType.type" id="sbt.inc.NameHashing.NameType">NameType</a> <a href="#sbt.inc.NameHashing.NameType" title="sbt.inc.NameHashing.NameType.type" class="delimiter">{</a>
		<span class="keyword">import</span> <a href="../../xsbti/api/DefinitionType.java.html#xsbti.api.DefinitionType" title="xsbti.api.DefinitionType.type">DefinitionType</a>._
		<span class="keyword">def</span> <a title="(dt: xsbti.api.DefinitionType)sbt.inc.NameHashing.NameType" id="sbt.inc.NameHashing.NameType.apply">apply</a><span class="delimiter">(</span><a title="xsbti.api.DefinitionType" id="sbt.inc.NameHashing.NameType.apply.dt">dt</a>: <a href="../../xsbti/api/DefinitionType.java.html#xsbti.api;DefinitionType" title="xsbti.api.DefinitionType">DefinitionType</a><span class="delimiter">)</span>: <a href="#sbt.inc.NameHashing;NameType" title="sbt.inc.NameHashing.NameType">NameType</a> = <a href="#sbt.inc.NameHashing.NameType.apply.dt" title="xsbti.api.DefinitionType">dt</a> <span title="sbt.inc.NameHashing.NameType" class="keyword">match</span> <span class="delimiter">{</span>
			<span class="keyword">case</span> <span title="xsbti.api.DefinitionType(Trait)">Trait</span> | <span title="xsbti.api.DefinitionType(ClassDef)">ClassDef</span> =&gt; <a href="#sbt.inc.NameHashing.TypeName.readResolve" title="sbt.inc.NameHashing.TypeName.type">TypeName</a>
			<span class="keyword">case</span> <span title="xsbti.api.DefinitionType(Module)">Module</span> | <span title="xsbti.api.DefinitionType(PackageModule)">PackageModule</span> =&gt; <a href="#sbt.inc.NameHashing.TermName.readResolve" title="sbt.inc.NameHashing.TermName.type">TermName</a>
		<span class="delimiter">}</span>
	<span class="delimiter">}</span>
	<span class="keyword">private</span> <span class="keyword">case object</span> <a href="#sbt.inc.NameHashing.TermName.productElement.x$1" title="sbt.inc.NameHashing.TermName.type" id="sbt.inc.NameHashing.TermName.readResolve">TermName</a> <span title="Product" class="keyword">extends</span> <a href="#sbt.inc.NameHashing;NameType" title="sbt.inc.NameHashing.NameType">NameType</a>
	<span class="keyword">private</span> <span class="keyword">case object</span> <a href="#sbt.inc.NameHashing.TypeName.productElement.x$1" title="sbt.inc.NameHashing.TypeName.type" id="sbt.inc.NameHashing.TypeName.readResolve">TypeName</a> <span title="Product" class="keyword">extends</span> <a href="#sbt.inc.NameHashing;NameType" title="sbt.inc.NameHashing.NameType">NameType</a>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>
