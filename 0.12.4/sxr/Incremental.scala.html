<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>Incremental.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2010  Mark Harrah
 */</span>
<span class="keyword">package</span> sbt
<span class="keyword">package</span> inc

<span class="keyword">import</span> xsbt.api.<span class="delimiter">{</span>NameChanges, SameAPI, TopLevel<span class="delimiter">}</span>
<span class="keyword">import</span> annotation.tailrec
<span class="keyword">import</span> xsbti.api.<span class="delimiter">{</span>Compilation, Source<span class="delimiter">}</span>
<span class="keyword">import</span> xsbti.compile.DependencyChanges
<span class="keyword">import</span> java.io.File

<span class="keyword">object</span> <a title="object sbt.inc.Incremental" id="9863">Incremental</a>
<span title="ScalaObject" class="delimiter">{</span>
	<span class="comment">// to be configurable</span>
	<span class="keyword">final</span> <span class="keyword">val</span> <a title="Int(2)" id="122672">TransitiveStep</a> = <span title="Int(2)" class="int">2</span>
	<span class="keyword">final</span> <span class="keyword">val</span> <a title="Double(0.5)" id="122674">RecompileAllFraction</a> = <span title="Double(0.5)" class="double">0.5</span>

	<span class="keyword">def</span> <a title="(sources: Set[java.io.File], entry: String =&gt; Option[java.io.File], previous: sbt.inc.Analysis, current: sbt.inc.ReadStamps, forEntry: java.io.File =&gt; Option[sbt.inc.Analysis], doCompile: (Set[java.io.File], xsbti.compile.DependencyChanges) =&gt; sbt.inc.Analysis, log: sbt.Logger)(implicit equivS: Equiv[sbt.inc.Stamp])(Boolean, sbt.inc.Analysis)" id="122676">compile</a><span class="delimiter">(</span><a title="Set[java.io.File]" id="122709">sources</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="String =&gt; Option[java.io.File]" id="122710">entry</a>: String =&gt; Option<span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="sbt.inc.Analysis" id="122711">previous</a>: <a href="Analysis.scala.html#9798" title="sbt.inc.Analysis">Analysis</a>, <a title="sbt.inc.ReadStamps" id="122712">current</a>: <a href="Stamp.scala.html#9898" title="sbt.inc.ReadStamps">ReadStamps</a>, <a title="java.io.File =&gt; Option[sbt.inc.Analysis]" id="122713">forEntry</a>: File =&gt; Option<span class="delimiter">[</span>Analysis<span class="delimiter">]</span>, <a title="(Set[java.io.File], xsbti.compile.DependencyChanges) =&gt; sbt.inc.Analysis" id="122714">doCompile</a>: <span class="delimiter">(</span>Set<span class="delimiter">[</span>File<span class="delimiter">]</span>, DependencyChanges<span class="delimiter">)</span> =&gt; Analysis, <a title="sbt.Logger" id="122715">log</a>: <a href="Logger.scala.html#13103" title="sbt.Logger">Logger</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Equiv[sbt.inc.Stamp]" id="122716">equivS</a>: <span title="Equiv[sbt.inc.Stamp]">Equiv</span><span class="delimiter">[</span>Stamp<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="(Boolean, sbt.inc.Analysis)" class="delimiter">(</span>Boolean, Analysis<span class="delimiter">)</span> =
	<span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="sbt.inc.InitialChanges" id="138336">initialChanges</a> = <a href="#122691" title="(entry: String =&gt; Option[java.io.File], sources: Set[java.io.File], previousAnalysis: sbt.inc.Analysis, current: sbt.inc.ReadStamps, forEntry: java.io.File =&gt; Option[sbt.inc.Analysis], log: sbt.Logger)(implicit equivS: Equiv[sbt.inc.Stamp])sbt.inc.InitialChanges">changedInitial</a><a href="#122716" title="Equiv[sbt.inc.Stamp]" class="delimiter">(</a><a href="#122710" title="String =&gt; Option[java.io.File]">entry</a>, <a href="#122709" title="Set[java.io.File]">sources</a>, <a href="#122711" title="sbt.inc.Analysis">previous</a>, <a href="#122712" title="sbt.inc.ReadStamps">current</a>, <a href="#122713" title="java.io.File =&gt; Option[sbt.inc.Analysis]">forEntry</a>, <a href="#122715" title="sbt.Logger">log</a><span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="binaryChanges extends java.lang.Object with xsbti.compile.DependencyChanges" id="138337">binaryChanges</a> = <a href="#138360" title="java.lang.Object with xsbti.compile.DependencyChanges{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with xsbti.compile.DependencyChanges" id="138360">DependencyChanges</a> <span class="delimiter">{</span>
			<span class="keyword">val</span> <a title="Array[java.io.File]" id="138362">modifiedBinaries</a> = <a href="#138336" title="sbt.inc.InitialChanges">initialChanges</a>.<a href="Changes.scala.html#122421" title="=&gt; Set[java.io.File]">binaryDeps</a>.<span title="(implicit evidence$1: ClassManifest[java.io.File])Array[java.io.File]">toArray</span>
			<span class="keyword">val</span> <a title="Array[String]" id="138364">modifiedClasses</a> = <a href="#138336" title="sbt.inc.InitialChanges">initialChanges</a>.<a href="Changes.scala.html#122423" title="=&gt; sbt.inc.APIChanges[String]">external</a>.<a href="Changes.scala.html#122438" title="=&gt; Set[String]">modified</a>.<span title="(implicit evidence$1: ClassManifest[String])Array[String]">toArray</span>
			<span class="keyword">def</span> <a title="()Boolean" id="138366">isEmpty</a> = <a href="#138362" title="(xs: Array[java.io.File])scala.collection.mutable.ArrayOps[java.io.File]">modifiedBinaries</a>.<span title="=&gt; Boolean">isEmpty</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#138364" title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]">modifiedClasses</a>.<span title="=&gt; Boolean">isEmpty</span>
		<span class="delimiter">}</span>
		<span class="keyword">val</span> <a title="Set[java.io.File]" id="138338">initialInv</a> = <a href="#122699" title="(previous: sbt.inc.Relations, changes: sbt.inc.InitialChanges, log: sbt.Logger)Set[java.io.File]">invalidateInitial</a><span class="delimiter">(</span><a href="#122711" title="sbt.inc.Analysis">previous</a>.<a href="Analysis.scala.html#120837" title="=&gt; sbt.inc.Relations">relations</a>, <a href="#138336" title="sbt.inc.InitialChanges">initialChanges</a>, <a href="#122715" title="sbt.Logger">log</a><span class="delimiter">)</span>
		<a href="#122715" title="sbt.Logger">log</a>.<a href="Logger.scala.html#53760" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;All initially invalidated sources: &quot;)" class="string">&quot;All initially invalidated sources: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#138338" title="Set[java.io.File]">initialInv</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span><span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="sbt.inc.Analysis" id="138339">analysis</a> = <a href="#122680" title="(invalidatedRaw: Set[java.io.File], allSources: Set[java.io.File], binaryChanges: xsbti.compile.DependencyChanges, previous: sbt.inc.Analysis, doCompile: (Set[java.io.File], xsbti.compile.DependencyChanges) =&gt; sbt.inc.Analysis, cycleNum: Int, log: sbt.Logger)sbt.inc.Analysis">cycle</a><span class="delimiter">(</span><a href="#138338" title="Set[java.io.File]">initialInv</a>, <a href="#122709" title="Set[java.io.File]">sources</a>, <a href="#138337" title="binaryChanges extends java.lang.Object with xsbti.compile.DependencyChanges">binaryChanges</a>, <a href="#122711" title="sbt.inc.Analysis">previous</a>, <a href="#122714" title="(Set[java.io.File], xsbti.compile.DependencyChanges) =&gt; sbt.inc.Analysis">doCompile</a>, <span title="Int(1)" class="int">1</span>, <a href="#122715" title="sbt.Logger">log</a><span class="delimiter">)</span>
		<span title="(_1: Boolean, _2: sbt.inc.Analysis)(Boolean, sbt.inc.Analysis)" class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#138338" title="Set[java.io.File]">initialInv</a>.<span title="=&gt; Boolean">isEmpty</span>, <a href="#138339" title="sbt.inc.Analysis">analysis</a><span class="delimiter">)</span>
	<span class="delimiter">}</span>

	<span class="comment">// setting the related system property to true will skip checking that the class name</span>
	<span class="comment">// still comes from the same classpath entry.  This can workaround bugs in classpath construction,</span>
	<span class="comment">// such as the currently problematic -javabootclasspath.  This is subject to removal at any time.</span>
	<span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="122677">skipClasspathLookup</a> = java.lang.<span title="object java.lang.Boolean">Boolean</span>.<span title="(x$1: java.lang.String)Boolean">getBoolean</span><span class="delimiter">(</span><span title="java.lang.String(&quot;xsbt.skip.cp.lookup&quot;)" class="string">&quot;xsbt.skip.cp.lookup&quot;</span><span class="delimiter">)</span>

	<span class="keyword">val</span> <a title="java.lang.String" id="122678">incDebugProp</a> = <span title="java.lang.String(&quot;xsbt.inc.debug&quot;)" class="string">&quot;xsbt.inc.debug&quot;</span>

	<span class="comment">// TODO: the Analysis for the last successful compilation should get returned + Boolean indicating success</span>
	<span class="comment">// TODO: full external name changes, scopeInvalidations</span>
	<span class="keyword">def</span> <a title="(invalidatedRaw: Set[java.io.File], allSources: Set[java.io.File], binaryChanges: xsbti.compile.DependencyChanges, previous: sbt.inc.Analysis, doCompile: (Set[java.io.File], xsbti.compile.DependencyChanges) =&gt; sbt.inc.Analysis, cycleNum: Int, log: sbt.Logger)sbt.inc.Analysis" id="122680">cycle</a><span class="delimiter">(</span><a title="Set[java.io.File]" id="138670">invalidatedRaw</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="138671">allSources</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="xsbti.compile.DependencyChanges" id="138672">binaryChanges</a>: <a href="xsbti/compile/DependencyChanges.java.html#10195" title="xsbti.compile.DependencyChanges">DependencyChanges</a>, <a title="sbt.inc.Analysis" id="138673">previous</a>: <a href="Analysis.scala.html#9798" title="sbt.inc.Analysis">Analysis</a>, <a title="(Set[java.io.File], xsbti.compile.DependencyChanges) =&gt; sbt.inc.Analysis" id="138674">doCompile</a>: <span class="delimiter">(</span>Set<span class="delimiter">[</span>File<span class="delimiter">]</span>, DependencyChanges<span class="delimiter">)</span> =&gt; Analysis, <a title="Int" id="138675">cycleNum</a>: <span title="Int">Int</span>, <a title="sbt.Logger" id="138676">log</a>: <a href="Logger.scala.html#13103" title="sbt.Logger">Logger</a><span class="delimiter">)</span>: <a href="Analysis.scala.html#9798" title="sbt.inc.Analysis">Analysis</a> =
		<span title="sbt.inc.Analysis" class="keyword">if</span><span class="delimiter">(</span><a href="#138670" title="Set[java.io.File]">invalidatedRaw</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span>
			<a href="#138673" title="sbt.inc.Analysis">previous</a>
		<span class="keyword">else</span>
		<span class="delimiter">{</span>
			<span class="keyword">def</span> <a title="(s: =&gt; String)Unit" id="138687">debug</a><span class="delimiter">(</span><a title="=&gt; String" id="138695">s</a>: =&gt; String<span class="delimiter">)</span> = <span title="Unit" class="keyword">if</span><span class="delimiter">(</span>java.lang.<span title="object java.lang.Boolean">Boolean</span>.<span title="(x$1: java.lang.String)Boolean">getBoolean</span><span class="delimiter">(</span><a href="#122678" title="=&gt; java.lang.String">incDebugProp</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#138676" title="sbt.Logger">log</a>.<a href="Logger.scala.html#53760" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><a href="#138695" title="=&gt; String">s</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
			<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="138688">withPackageObjects</a> = <a href="#138670" title="Set[java.io.File]">invalidatedRaw</a> <span title="(elems: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">++</span> <a href="#122683" title="(invalidated: Set[java.io.File], relations: sbt.inc.Relations)Set[java.io.File]">invalidatedPackageObjects</a><span class="delimiter">(</span><a href="#138670" title="Set[java.io.File]">invalidatedRaw</a>, <a href="#138673" title="sbt.inc.Analysis">previous</a>.<a href="Analysis.scala.html#120837" title="=&gt; sbt.inc.Relations">relations</a><span class="delimiter">)</span>
			<span class="keyword">val</span> <a title="Set[java.io.File]" id="138689">invalidated</a> = <a href="#122682" title="(invalidated: Set[java.io.File], all: Set[java.io.File], log: sbt.Logger)Set[java.io.File]">expand</a><span class="delimiter">(</span><a href="#138688" title="scala.collection.immutable.Set[java.io.File]">withPackageObjects</a>, <a href="#138671" title="Set[java.io.File]">allSources</a>, <a href="#138676" title="sbt.Logger">log</a><span class="delimiter">)</span>
			<span class="keyword">val</span> <a title="sbt.inc.Analysis" id="138690">pruned</a> = <a href="#122700" title="(invalidatedSrcs: Set[java.io.File], previous: sbt.inc.Analysis)sbt.inc.Analysis">prune</a><span class="delimiter">(</span><a href="#138689" title="Set[java.io.File]">invalidated</a>, <a href="#138673" title="sbt.inc.Analysis">previous</a><span class="delimiter">)</span>
			<a href="#138687" title="(s: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;********* Pruned: \012&quot;)" class="string">&quot;********* Pruned: \n&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#138690" title="sbt.inc.Analysis">pruned</a>.<a href="Analysis.scala.html#120837" title="=&gt; sbt.inc.Relations">relations</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\012*********&quot;)" class="string">&quot;\n*********&quot;</span><span class="delimiter">)</span>
			<span class="keyword">val</span> <a title="sbt.inc.Analysis" id="138691">fresh</a> = <a href="#138674" title="(v1: Set[java.io.File], v2: xsbti.compile.DependencyChanges)sbt.inc.Analysis">doCompile</a><span class="delimiter">(</span><a href="#138689" title="Set[java.io.File]">invalidated</a>, <a href="#138672" title="xsbti.compile.DependencyChanges">binaryChanges</a><span class="delimiter">)</span>
			<a href="#138687" title="(s: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;********* Fresh: \012&quot;)" class="string">&quot;********* Fresh: \n&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#138691" title="sbt.inc.Analysis">fresh</a>.<a href="Analysis.scala.html#120837" title="=&gt; sbt.inc.Relations">relations</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\012*********&quot;)" class="string">&quot;\n*********&quot;</span><span class="delimiter">)</span>
			<span class="keyword">val</span> <a title="sbt.inc.Analysis" id="138692">merged</a> = <a href="#138690" title="sbt.inc.Analysis">pruned</a> <a href="Analysis.scala.html#120839" title="(other: sbt.inc.Analysis)sbt.inc.Analysis">++</a> <a href="#138691" title="sbt.inc.Analysis">fresh</a><span class="comment">//.copy(relations = pruned.relations ++ fresh.relations, apis = pruned.apis ++ fresh.apis)</span>
			<a href="#138687" title="(s: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;********* Merged: \012&quot;)" class="string">&quot;********* Merged: \n&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#138692" title="sbt.inc.Analysis">merged</a>.<a href="Analysis.scala.html#120837" title="=&gt; sbt.inc.Relations">relations</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\012*********&quot;)" class="string">&quot;\n*********&quot;</span><span class="delimiter">)</span>
			<span class="keyword">val</span> <a title="sbt.inc.APIChanges[java.io.File]" id="138693">incChanges</a> = <a href="#122684" title="(lastSources: scala.collection.Set[java.io.File], oldAPI: java.io.File =&gt; xsbti.api.Source, newAPI: java.io.File =&gt; xsbti.api.Source)sbt.inc.APIChanges[java.io.File]">changedIncremental</a><span class="delimiter">(</span><a href="#138689" title="Set[java.io.File]">invalidated</a>, <a href="#138673" title="sbt.inc.Analysis">previous</a>.<a href="Analysis.scala.html#120836" title="=&gt; sbt.inc.APIs">apis</a>.<a href="APIs.scala.html#120352" title="(src: java.io.File)xsbti.api.Source">internalAPI</a> _, <a href="#138692" title="sbt.inc.Analysis">merged</a>.<a href="Analysis.scala.html#120836" title="=&gt; sbt.inc.APIs">apis</a>.<a href="APIs.scala.html#120352" title="(src: java.io.File)xsbti.api.Source">internalAPI</a> _<span class="delimiter">)</span>
			<a href="#138687" title="(s: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Changes:\012&quot;)" class="string">&quot;Changes:\n&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#138693" title="sbt.inc.APIChanges[java.io.File]">incChanges</a><span class="delimiter">)</span>
			<span class="keyword">val</span> <a title="Set[java.io.File]" id="138694">incInv</a> = <a href="#122693" title="(previous: sbt.inc.Relations, changes: sbt.inc.APIChanges[java.io.File], recompiledSources: Set[java.io.File], transitive: Boolean, log: sbt.Logger)Set[java.io.File]">invalidateIncremental</a><span class="delimiter">(</span><a href="#138692" title="sbt.inc.Analysis">merged</a>.<a href="Analysis.scala.html#120837" title="=&gt; sbt.inc.Relations">relations</a>, <a href="#138693" title="sbt.inc.APIChanges[java.io.File]">incChanges</a>, <a href="#138689" title="Set[java.io.File]">invalidated</a>, <a href="#138675" title="Int">cycleNum</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(2)">TransitiveStep</span>, <a href="#138676" title="sbt.Logger">log</a><span class="delimiter">)</span>
			<a href="#122680" title="(invalidatedRaw: Set[java.io.File], allSources: Set[java.io.File], binaryChanges: xsbti.compile.DependencyChanges, previous: sbt.inc.Analysis, doCompile: (Set[java.io.File], xsbti.compile.DependencyChanges) =&gt; sbt.inc.Analysis, cycleNum: Int, log: sbt.Logger)sbt.inc.Analysis">cycle</a><span class="delimiter">(</span><a href="#138694" title="Set[java.io.File]">incInv</a>, <a href="#138671" title="Set[java.io.File]">allSources</a>, <a href="#122681" title="=&gt; xsbti.compile.DependencyChanges">emptyChanges</a>, <a href="#138692" title="sbt.inc.Analysis">merged</a>, <a href="#138674" title="(Set[java.io.File], xsbti.compile.DependencyChanges) =&gt; sbt.inc.Analysis">doCompile</a>, <a href="#138675" title="Int">cycleNum</a><span title="(x: Int)Int">+</span><span title="Int(1)" class="int">1</span>, <a href="#138676" title="sbt.Logger">log</a><span class="delimiter">)</span>
		<span class="delimiter">}</span>
	<span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="=&gt; xsbti.compile.DependencyChanges" id="122681">emptyChanges</a>: <a href="xsbti/compile/DependencyChanges.java.html#10195" title="xsbti.compile.DependencyChanges">DependencyChanges</a> = <a href="#138799" title="java.lang.Object with xsbti.compile.DependencyChanges{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with xsbti.compile.DependencyChanges" id="138799">DependencyChanges</a> <span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="Array[java.io.File]" id="138803">modifiedBinaries</a> = <span title="Array[java.io.File]" class="keyword">new</span> <span title="Array[java.io.File]">Array</span><span class="delimiter">[</span>File<span class="delimiter">]</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="Array[String]" id="138805">modifiedClasses</a> = <span title="Array[String]" class="keyword">new</span> <span title="Array[String]">Array</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
		<span class="keyword">def</span> <a title="()Boolean" id="138807">isEmpty</a> = <span title="Boolean(true)" class="keyword">true</span>
	<span class="delimiter">}</span>
	<span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="(invalidated: Set[java.io.File], all: Set[java.io.File], log: sbt.Logger)Set[java.io.File]" id="122682">expand</a><span class="delimiter">(</span><a title="Set[java.io.File]" id="138748">invalidated</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="138749">all</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="sbt.Logger" id="138750">log</a>: <a href="Logger.scala.html#13103" title="sbt.Logger">Logger</a><span class="delimiter">)</span>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span> =
		<span title="Set[java.io.File]" class="keyword">if</span><span class="delimiter">(</span><a href="#138748" title="Set[java.io.File]">invalidated</a>.<span title="=&gt; Int">size</span> <span title="(x: Double)Boolean">&gt;</span> <a href="#138749" title="Set[java.io.File]">all</a>.<span title="=&gt; Int">size</span> <span title="(x: Double)Double">*</span> <span title="Double(0.5)">RecompileAllFraction</span><span class="delimiter">)</span> <span class="delimiter">{</span>
			<a href="#138750" title="sbt.Logger">log</a>.<a href="Logger.scala.html#53760" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Recompiling all &quot;)" class="string">&quot;Recompiling all &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#138749" title="Set[java.io.File]">all</a>.<span title="=&gt; Int">size</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; sources: invalidated sources (&quot;)" class="string">&quot; sources: invalidated sources (&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#138748" title="Set[java.io.File]">invalidated</a>.<span title="=&gt; Int">size</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;) exceeded &quot;)" class="string">&quot;) exceeded &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <span class="delimiter">(</span>RecompileAllFraction<span title="Double(50.0)">*</span><span class="double">100.0</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;% of all sources&quot;)" class="string">&quot;% of all sources&quot;</span><span class="delimiter">)</span>
			<a href="#138749" title="Set[java.io.File]">all</a> <span title="(elems: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">++</span> <a href="#138748" title="Set[java.io.File]">invalidated</a> <span class="comment">// need the union because all doesn't contain removed sources</span>
		<span class="delimiter">}</span>
		<span class="keyword">else</span> <a href="#138748" title="Set[java.io.File]">invalidated</a>

	<span class="comment">// Package objects are fragile: if they depend on an invalidated source, get &quot;class file needed by package is missing&quot; error</span>
	<span class="comment">//  This might be too conservative: we probably only need package objects for packages of invalidated sources.</span>
	<span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="(invalidated: Set[java.io.File], relations: sbt.inc.Relations)Set[java.io.File]" id="122683">invalidatedPackageObjects</a><span class="delimiter">(</span><a title="Set[java.io.File]" id="138724">invalidated</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="sbt.inc.Relations" id="138725">relations</a>: <a href="Relations.scala.html#9878" title="sbt.inc.Relations">Relations</a><span class="delimiter">)</span>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span> =
		<a href="#138724" title="Set[java.io.File]">invalidated</a> <span title="(f: java.io.File =&gt; scala.collection.GenTraversableOnce[java.io.File])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[java.io.File],java.io.File,scala.collection.immutable.Set[java.io.File]])scala.collection.immutable.Set[java.io.File]">flatMap</span> <a href="#138725" title="sbt.inc.Relations">relations</a>.<a href="Relations.scala.html#120884" title="(dep: java.io.File)Set[java.io.File]">usesInternalSrc</a> <span title="(p: java.io.File =&gt; Boolean)scala.collection.immutable.Set[java.io.File]">filter</span> <span class="delimiter">{</span> <a href="#138967" title="java.io.File">_</a>.<span title="()java.lang.String">getName</span> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.lang.String(&quot;package.scala&quot;)" class="string">&quot;package.scala&quot;</span> <span class="delimiter">}</span>

	<span class="comment">/**
	* Accepts the sources that were recompiled during the last step and functions
	* providing the API before and after the last step.  The functions should return
	* an empty API if the file did not/does not exist.
	*/</span>
	<span class="keyword">def</span> <a title="[T](lastSources: scala.collection.Set[T], oldAPI: T =&gt; xsbti.api.Source, newAPI: T =&gt; xsbti.api.Source)sbt.inc.APIChanges[T]" id="122684">changedIncremental</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="122686">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.Set[T]" id="138757">lastSources</a>: collection.<span title="scala.collection.Set[T]">Set</span><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="T =&gt; xsbti.api.Source" id="138758">oldAPI</a>: T =&gt; Source, <a title="T =&gt; xsbti.api.Source" id="138759">newAPI</a>: T =&gt; Source<span class="delimiter">)</span>: <a href="Changes.scala.html#9816" title="sbt.inc.APIChanges[T]">APIChanges</a><span class="delimiter">[</span>T<span class="delimiter">]</span> =
	<span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="Seq[xsbti.api.Source]" id="138973">oldApis</a> = <a href="#138757" title="scala.collection.Set[T]">lastSources</a>.<span title="=&gt; Seq[T]">toSeq</span> <span title="(f: T =&gt; xsbti.api.Source)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[T],xsbti.api.Source,Seq[xsbti.api.Source]])Seq[xsbti.api.Source]">map</span> <a href="#138758" title="T =&gt; xsbti.api.Source">oldAPI</a>
		<span class="keyword">val</span> <a title="Seq[xsbti.api.Source]" id="138974">newApis</a> = <a href="#138757" title="scala.collection.Set[T]">lastSources</a>.<span title="=&gt; Seq[T]">toSeq</span> <span title="(f: T =&gt; xsbti.api.Source)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[T],xsbti.api.Source,Seq[xsbti.api.Source]])Seq[xsbti.api.Source]">map</span> <a href="#138759" title="T =&gt; xsbti.api.Source">newAPI</a>
		<span class="keyword">val</span> <a title="(scala.collection.Set[T], Seq[xsbti.api.Source], Seq[xsbti.api.Source])" id="138975">changes</a> = <span title="(_1: scala.collection.Set[T], _2: Seq[xsbti.api.Source], _3: Seq[xsbti.api.Source])(scala.collection.Set[T], Seq[xsbti.api.Source], Seq[xsbti.api.Source])" class="delimiter">(</span><a href="#138757" title="scala.collection.Set[T]">lastSources</a>, <a href="#138973" title="Seq[xsbti.api.Source]">oldApis</a>, <a href="#138974" title="Seq[xsbti.api.Source]">newApis</a><span class="delimiter">)</span>.<span title="(implicit w1: scala.collection.Set[T] =&gt; scala.collection.TraversableLike[T,scala.collection.Set[T]], implicit w2: Seq[xsbti.api.Source] =&gt; scala.collection.IterableLike[xsbti.api.Source,Seq[xsbti.api.Source]], implicit w3: Seq[xsbti.api.Source] =&gt; scala.collection.IterableLike[xsbti.api.Source,Seq[xsbti.api.Source]])(scala.collection.Set[T], Seq[xsbti.api.Source], Seq[xsbti.api.Source])#Zipped[scala.collection.Set[T],T,Seq[xsbti.api.Source],xsbti.api.Source,Seq[xsbti.api.Source],xsbti.api.Source]">zipped</span>.<span title="(f: (T, xsbti.api.Source, xsbti.api.Source) =&gt; Boolean)(implicit cbf1: scala.collection.generic.CanBuildFrom[scala.collection.Set[T],T,scala.collection.Set[T]], implicit cbf2: scala.collection.generic.CanBuildFrom[Seq[xsbti.api.Source],xsbti.api.Source,Seq[xsbti.api.Source]], implicit cbf3: scala.collection.generic.CanBuildFrom[Seq[xsbti.api.Source],xsbti.api.Source,Seq[xsbti.api.Source]])(scala.collection.Set[T], Seq[xsbti.api.Source], Seq[xsbti.api.Source])">filter</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.Set.Coll,T,scala.collection.Set[T]]" class="delimiter">{</span> <span class="delimiter">(</span><a title="T" id="139140">src</a>, <a title="xsbti.api.Source" id="139141">oldApi</a>, <a title="xsbti.api.Source" id="139142">newApi</a><span class="delimiter">)</span> =&gt; <span title="=&gt; Boolean">!</span><a href="#122687" title="(a: xsbti.api.Source, b: xsbti.api.Source)Boolean">sameSource</a><span class="delimiter">(</span><a href="#139141" title="xsbti.api.Source">oldApi</a>, <a href="#139142" title="xsbti.api.Source">newApi</a><span class="delimiter">)</span> <span class="delimiter">}</span>

		<span class="keyword">val</span> <a title="xsbt.api.NameChanges" id="138976">changedNames</a> = <a href="SameAPI.scala.html#9747" title="object xsbt.api.TopLevel">TopLevel</a>.<a href="SameAPI.scala.html#111205" title="(a: Iterable[xsbti.api.Source], b: Iterable[xsbti.api.Source])xsbt.api.NameChanges">nameChanges</a><span class="delimiter">(</span><a href="#138975" title="(scala.collection.Set[T], Seq[xsbti.api.Source], Seq[xsbti.api.Source])">changes</a>.<span title="=&gt; Seq[xsbti.api.Source]">_3</span>, <a href="#138975" title="(scala.collection.Set[T], Seq[xsbti.api.Source], Seq[xsbti.api.Source])">changes</a>.<span title="=&gt; Seq[xsbti.api.Source]">_2</span> <span class="delimiter">)</span>

		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[T]" id="138977">modifiedAPIs</a> = <a href="#138975" title="(scala.collection.Set[T], Seq[xsbti.api.Source], Seq[xsbti.api.Source])">changes</a>.<span title="=&gt; scala.collection.Set[T]">_1</span>.<span title="scala.collection.immutable.Set[T]">toSet</span>

		<span title="sbt.inc.APIChanges[T]" class="keyword">new</span> <a href="Changes.scala.html#9816" title="sbt.inc.APIChanges[T]">APIChanges</a><span class="delimiter">(</span><a href="#138977" title="scala.collection.immutable.Set[T]">modifiedAPIs</a>, <a href="#138976" title="xsbt.api.NameChanges">changedNames</a><span class="delimiter">)</span>
	<span class="delimiter">}</span>
	<span class="keyword">def</span> <a title="(a: xsbti.api.Source, b: xsbti.api.Source)Boolean" id="122687">sameSource</a><span class="delimiter">(</span><a title="xsbti.api.Source" id="139143">a</a>: <a href="xsbti/api/Source.java.html#10438" title="xsbti.api.Source">Source</a>, <a title="xsbti.api.Source" id="139144">b</a>: <a href="xsbti/api/Source.java.html#10438" title="xsbti.api.Source">Source</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
		<span class="comment">// Clients of a modified source file (ie, one that doesn't satisfy `shortcutSameSource`) containing macros must be recompiled.</span>
		<span class="keyword">val</span> <a title="Boolean" id="139253">hasMacro</a> = <a href="#139143" title="xsbti.api.Source">a</a>.<a href="xsbti/api/Source.java.html#111226" title="()Boolean">hasMacro</a> <span title="(x: Boolean)Boolean">||</span> <a href="#139144" title="xsbti.api.Source">b</a>.<a href="xsbti/api/Source.java.html#111226" title="()Boolean">hasMacro</a>
		<a href="#122688" title="(a: xsbti.api.Source, b: xsbti.api.Source)Boolean">shortcutSameSource</a><span class="delimiter">(</span><a href="#139143" title="xsbti.api.Source">a</a>, <a href="#139144" title="xsbti.api.Source">b</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#139253" title="Boolean">hasMacro</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="SameAPI.scala.html#107726" title="(a: xsbti.api.Source, b: xsbti.api.Source)Boolean">SameAPI</a><span class="delimiter">(</span><a href="#139143" title="xsbti.api.Source">a</a>,<a href="#139144" title="xsbti.api.Source">b</a><span class="delimiter">)</span><span class="delimiter">)</span>
	<span class="delimiter">}</span>

	<span class="keyword">def</span> <a title="(a: xsbti.api.Source, b: xsbti.api.Source)Boolean" id="122688">shortcutSameSource</a><span class="delimiter">(</span><a title="xsbti.api.Source" id="139257">a</a>: <a href="xsbti/api/Source.java.html#10438" title="xsbti.api.Source">Source</a>, <a title="xsbti.api.Source" id="139258">b</a>: <a href="xsbti/api/Source.java.html#10438" title="xsbti.api.Source">Source</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span>  =  <span title="=&gt; Boolean">!</span><a href="#139257" title="xsbti.api.Source">a</a>.<a href="xsbti/api/Source.java.html#111223" title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]">hash</a>.<span title="=&gt; Boolean">isEmpty</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#139258" title="xsbti.api.Source">b</a>.<a href="xsbti/api/Source.java.html#111223" title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]">hash</a>.<span title="=&gt; Boolean">isEmpty</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#122689" title="(a: xsbti.api.Compilation, b: xsbti.api.Compilation)Boolean">sameCompilation</a><span class="delimiter">(</span><a href="#139257" title="xsbti.api.Source">a</a>.<a href="xsbti/api/Source.java.html#111222" title="()xsbti.api.Compilation">compilation</a>, <a href="#139258" title="xsbti.api.Source">b</a>.<a href="xsbti/api/Source.java.html#111222" title="()xsbti.api.Compilation">compilation</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span class="delimiter">(</span><a href="#139257" title="xsbti.api.Source">a</a>.<a href="xsbti/api/Source.java.html#111223" title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]">hash</a> <span title="(that: Any)Boolean">deepEquals</span> <a href="#139258" title="xsbti.api.Source">b</a>.<a href="xsbti/api/Source.java.html#111223" title="()Array[Byte]">hash</a><span class="delimiter">)</span>
	<span class="keyword">def</span> <a title="(a: xsbti.api.Compilation, b: xsbti.api.Compilation)Boolean" id="122689">sameCompilation</a><span class="delimiter">(</span><a title="xsbti.api.Compilation" id="139472">a</a>: <a href="xsbti/api/Compilation.java.html#10274" title="xsbti.api.Compilation">Compilation</a>, <a title="xsbti.api.Compilation" id="139473">b</a>: <a href="xsbti/api/Compilation.java.html#10274" title="xsbti.api.Compilation">Compilation</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span>  =  <a href="#139472" title="xsbti.api.Compilation">a</a>.<a href="xsbti/api/Compilation.java.html#120426" title="()Long">startTime</a> <span title="(x: Long)Boolean">==</span> <a href="#139473" title="xsbti.api.Compilation">b</a>.<a href="xsbti/api/Compilation.java.html#120426" title="()Long">startTime</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#139472" title="xsbti.api.Compilation">a</a>.<a href="xsbti/api/Compilation.java.html#120427" title="()java.lang.String">target</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#139473" title="xsbti.api.Compilation">b</a>.<a href="xsbti/api/Compilation.java.html#120427" title="()java.lang.String">target</a>

	<span class="comment">// for binary compatibility in 0.12.x</span>
	<span class="keyword">def</span> <a title="(entry: String =&gt; Option[java.io.File], sources: Set[java.io.File], previousAnalysis: sbt.inc.Analysis, current: sbt.inc.ReadStamps, forEntry: java.io.File =&gt; Option[sbt.inc.Analysis])(implicit equivS: Equiv[sbt.inc.Stamp])sbt.inc.InitialChanges" id="122690">changedInitial</a><span class="delimiter">(</span><a title="String =&gt; Option[java.io.File]" id="138352">entry</a>: String =&gt; Option<span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="138353">sources</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="sbt.inc.Analysis" id="138354">previousAnalysis</a>: <a href="Analysis.scala.html#9798" title="sbt.inc.Analysis">Analysis</a>, <a title="sbt.inc.ReadStamps" id="138355">current</a>: <a href="Stamp.scala.html#9898" title="sbt.inc.ReadStamps">ReadStamps</a>, <a title="java.io.File =&gt; Option[sbt.inc.Analysis]" id="138356">forEntry</a>: File =&gt; Option<span class="delimiter">[</span>Analysis<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Equiv[sbt.inc.Stamp]" id="138357">equivS</a>: <span title="Equiv[sbt.inc.Stamp]">Equiv</span><span class="delimiter">[</span>Stamp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="Changes.scala.html#9813" title="sbt.inc.InitialChanges">InitialChanges</a> =
		<a href="#122691" title="(entry: String =&gt; Option[java.io.File], sources: Set[java.io.File], previousAnalysis: sbt.inc.Analysis, current: sbt.inc.ReadStamps, forEntry: java.io.File =&gt; Option[sbt.inc.Analysis], log: sbt.Logger)(implicit equivS: Equiv[sbt.inc.Stamp])sbt.inc.InitialChanges">changedInitial</a><span class="delimiter">(</span><a href="#138352" title="String =&gt; Option[java.io.File]">entry</a>, <a href="#138353" title="Set[java.io.File]">sources</a>, <a href="#138354" title="sbt.inc.Analysis">previousAnalysis</a>, <a href="#138355" title="sbt.inc.ReadStamps">current</a>, <a href="#138356" title="java.io.File =&gt; Option[sbt.inc.Analysis]">forEntry</a>, <a href="Logger.scala.html#13101" title="object sbt.Logger">Logger</a>.<a href="Logger.scala.html#54047" title="=&gt; sbt.AbstractLogger">Null</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#138357" title="Equiv[sbt.inc.Stamp]">equivS</a><span class="delimiter">)</span>

	<span class="keyword">def</span> <a title="(entry: String =&gt; Option[java.io.File], sources: Set[java.io.File], previousAnalysis: sbt.inc.Analysis, current: sbt.inc.ReadStamps, forEntry: java.io.File =&gt; Option[sbt.inc.Analysis], log: sbt.Logger)(implicit equivS: Equiv[sbt.inc.Stamp])sbt.inc.InitialChanges" id="122691">changedInitial</a><span class="delimiter">(</span><a title="String =&gt; Option[java.io.File]" id="138344">entry</a>: String =&gt; Option<span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="138345">sources</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="sbt.inc.Analysis" id="138346">previousAnalysis</a>: <a href="Analysis.scala.html#9798" title="sbt.inc.Analysis">Analysis</a>, <a title="sbt.inc.ReadStamps" id="138347">current</a>: <a href="Stamp.scala.html#9898" title="sbt.inc.ReadStamps">ReadStamps</a>, <a title="java.io.File =&gt; Option[sbt.inc.Analysis]" id="138348">forEntry</a>: File =&gt; Option<span class="delimiter">[</span>Analysis<span class="delimiter">]</span>, <a title="sbt.Logger" id="138349">log</a>: <a href="Logger.scala.html#13103" title="sbt.Logger">Logger</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Equiv[sbt.inc.Stamp]" id="138350">equivS</a>: <span title="Equiv[sbt.inc.Stamp]">Equiv</span><span class="delimiter">[</span>Stamp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="Changes.scala.html#9813" title="sbt.inc.InitialChanges">InitialChanges</a> =
	<span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="sbt.inc.Stamps" id="139521">previous</a> = <a href="#138346" title="sbt.inc.Analysis">previousAnalysis</a>.<a href="Analysis.scala.html#120835" title="=&gt; sbt.inc.Stamps">stamps</a>
		<span class="keyword">val</span> <a title="sbt.inc.APIs" id="139522">previousAPIs</a> = <a href="#138346" title="sbt.inc.Analysis">previousAnalysis</a>.<a href="Analysis.scala.html#120836" title="=&gt; sbt.inc.APIs">apis</a>
		
		<span class="keyword">val</span> <a title="sbt.inc.Changes[java.io.File]" id="139523">srcChanges</a> = <a href="#122692" title="(previous: Set[java.io.File], current: Set[java.io.File], existingModified: java.io.File =&gt; Boolean)sbt.inc.Changes[java.io.File]">changes</a><span class="delimiter">(</span><a href="#139521" title="sbt.inc.Stamps">previous</a>.<a href="Stamp.scala.html#120859" title="=&gt; scala.collection.Set[java.io.File]">allInternalSources</a>.<span title="scala.collection.immutable.Set[java.io.File]">toSet</span>, <a href="#138345" title="Set[java.io.File]">sources</a>,  <a title="java.io.File" id="139542">f</a> =&gt; <span title="=&gt; Boolean">!</span><a href="#138350" title="Equiv[sbt.inc.Stamp]">equivS</a>.<span title="(x: sbt.inc.Stamp, y: sbt.inc.Stamp)Boolean">equiv</span><span class="delimiter">(</span> <a href="#139521" title="sbt.inc.Stamps">previous</a>.<a href="Stamp.scala.html#120857" title="(src: java.io.File)sbt.inc.Stamp">internalSource</a><span class="delimiter">(</span><a href="#139542" title="java.io.File">f</a><span class="delimiter">)</span>, <a href="#138347" title="sbt.inc.ReadStamps">current</a>.<a href="Stamp.scala.html#120857" title="(src: java.io.File)sbt.inc.Stamp">internalSource</a><span class="delimiter">(</span><a href="#139542" title="java.io.File">f</a><span class="delimiter">)</span> <span class="delimiter">)</span> <span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="139524">removedProducts</a> = <a href="#139521" title="sbt.inc.Stamps">previous</a>.<a href="Stamp.scala.html#120861" title="=&gt; scala.collection.Set[java.io.File]">allProducts</a>.<span title="(p: java.io.File =&gt; Boolean)scala.collection.Set[java.io.File]">filter</span><span class="delimiter">(</span> <a title="java.io.File" id="139550">p</a> =&gt; <span title="=&gt; Boolean">!</span><a href="#138350" title="Equiv[sbt.inc.Stamp]">equivS</a>.<span title="(x: sbt.inc.Stamp, y: sbt.inc.Stamp)Boolean">equiv</span><span class="delimiter">(</span> <a href="#139521" title="sbt.inc.Stamps">previous</a>.<a href="Stamp.scala.html#120856" title="(prod: java.io.File)sbt.inc.Stamp">product</a><span class="delimiter">(</span><a href="#139550" title="java.io.File">p</a><span class="delimiter">)</span>, <a href="#138347" title="sbt.inc.ReadStamps">current</a>.<a href="Stamp.scala.html#120856" title="(prod: java.io.File)sbt.inc.Stamp">product</a><span class="delimiter">(</span><a href="#139550" title="java.io.File">p</a><span class="delimiter">)</span> <span class="delimiter">)</span> <span class="delimiter">)</span>.<span title="scala.collection.immutable.Set[java.io.File]">toSet</span>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="139525">binaryDepChanges</a> = <a href="#139521" title="sbt.inc.Stamps">previous</a>.<a href="Stamp.scala.html#120860" title="=&gt; scala.collection.Set[java.io.File]">allBinaries</a>.<span title="(p: java.io.File =&gt; Boolean)scala.collection.Set[java.io.File]">filter</span><span class="delimiter">(</span> <a href="#122702" title="(entry: String =&gt; Option[java.io.File], analysis: java.io.File =&gt; Option[sbt.inc.Analysis], previous: sbt.inc.Stamps, current: sbt.inc.ReadStamps, log: sbt.Logger)(implicit equivS: Equiv[sbt.inc.Stamp])java.io.File =&gt; Boolean">externalBinaryModified</a><a href="#138350" title="Equiv[sbt.inc.Stamp]" class="delimiter">(</a><a href="#138344" title="String =&gt; Option[java.io.File]">entry</a>, <a href="#138348" title="java.io.File =&gt; Option[sbt.inc.Analysis]">forEntry</a>, <a href="#139521" title="sbt.inc.Stamps">previous</a>, <a href="#138347" title="sbt.inc.ReadStamps">current</a>, <a href="#138349" title="sbt.Logger">log</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="scala.collection.immutable.Set[java.io.File]">toSet</span>
		<span class="keyword">val</span> <a title="sbt.inc.APIChanges[String]" id="139526">extChanges</a> = <a href="#122684" title="(lastSources: scala.collection.Set[String], oldAPI: String =&gt; xsbti.api.Source, newAPI: String =&gt; xsbti.api.Source)sbt.inc.APIChanges[String]">changedIncremental</a><span class="delimiter">(</span><a href="#139522" title="sbt.inc.APIs">previousAPIs</a>.<a href="APIs.scala.html#120354" title="=&gt; scala.collection.Set[String]">allExternals</a>, <a href="#139522" title="sbt.inc.APIs">previousAPIs</a>.<a href="APIs.scala.html#120353" title="(ext: String)xsbti.api.Source">externalAPI</a> _, <a href="#122703" title="(entry: String =&gt; Option[java.io.File], forEntry: java.io.File =&gt; Option[sbt.inc.Analysis])String =&gt; xsbti.api.Source">currentExternalAPI</a><span class="delimiter">(</span><a href="#138344" title="String =&gt; Option[java.io.File]">entry</a>, <a href="#138348" title="java.io.File =&gt; Option[sbt.inc.Analysis]">forEntry</a><span class="delimiter">)</span><span class="delimiter">)</span>

		<a href="Changes.scala.html#122475" title="(internalSrc: sbt.inc.Changes[java.io.File], removedProducts: Set[java.io.File], binaryDeps: Set[java.io.File], external: sbt.inc.APIChanges[String])sbt.inc.InitialChanges">InitialChanges</a><span class="delimiter">(</span><a href="#139523" title="sbt.inc.Changes[java.io.File]">srcChanges</a>, <a href="#139524" title="scala.collection.immutable.Set[java.io.File]">removedProducts</a>, <a href="#139525" title="scala.collection.immutable.Set[java.io.File]">binaryDepChanges</a>, <a href="#139526" title="sbt.inc.APIChanges[String]">extChanges</a> <span class="delimiter">)</span>
	<span class="delimiter">}</span>

	<span class="keyword">def</span> <a title="(previous: Set[java.io.File], current: Set[java.io.File], existingModified: java.io.File =&gt; Boolean)sbt.inc.Changes[java.io.File]" id="122692">changes</a><span class="delimiter">(</span><a title="Set[java.io.File]" id="139527">previous</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="139528">current</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="java.io.File =&gt; Boolean" id="139529">existingModified</a>: File =&gt; Boolean<span class="delimiter">)</span>: <a href="Changes.scala.html#9818" title="sbt.inc.Changes[java.io.File]">Changes</a><span class="delimiter">[</span>File<span class="delimiter">]</span> =
		<a href="#139622" title="java.lang.Object with sbt.inc.Changes[java.io.File]{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with sbt.inc.Changes[java.io.File]" id="139622">Changes</a><span class="delimiter">[</span>File<span class="delimiter">]</span>
		<span class="delimiter">{</span>
			<span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="139626">inBoth</a> = <a href="#139527" title="Set[java.io.File]">previous</a> <span title="(that: scala.collection.GenSet[java.io.File])scala.collection.immutable.Set[java.io.File]">&amp;</span> <a href="#139528" title="Set[java.io.File]">current</a>
			<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="139628">removed</a> = <a href="#139527" title="Set[java.io.File]">previous</a> <span title="(xs: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">--</span> <a href="#139626" title="=&gt; scala.collection.immutable.Set[java.io.File]">inBoth</a>
			<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="139630">added</a> = <a href="#139528" title="Set[java.io.File]">current</a> <span title="(xs: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">--</span> <a href="#139626" title="=&gt; scala.collection.immutable.Set[java.io.File]">inBoth</a>
			<span class="keyword">val</span> <a href="#139633" title="(scala.collection.immutable.Set[java.io.File], scala.collection.immutable.Set[java.io.File])" class="delimiter">(</a><a href="#139632" title="scala.collection.immutable.Set[java.io.File]" id="139633">changed</a>, <a href="#139632" title="scala.collection.immutable.Set[java.io.File]" id="139635">unmodified</a><span class="delimiter">)</span> = <a href="#139626" title="=&gt; scala.collection.immutable.Set[java.io.File]">inBoth</a>.<span title="(p: java.io.File =&gt; Boolean)(scala.collection.immutable.Set[java.io.File], scala.collection.immutable.Set[java.io.File])">partition</span><span title="(scala.collection.immutable.Set[java.io.File], scala.collection.immutable.Set[java.io.File]) @unchecked" class="delimiter">(</span><a href="#139529" title="java.io.File =&gt; Boolean">existingModified</a><span class="delimiter">)</span>
		<span class="delimiter">}</span>

	<span class="keyword">def</span> <a title="(previous: sbt.inc.Relations, changes: sbt.inc.APIChanges[java.io.File], recompiledSources: Set[java.io.File], transitive: Boolean, log: sbt.Logger)Set[java.io.File]" id="122693">invalidateIncremental</a><span class="delimiter">(</span><a title="sbt.inc.Relations" id="138783">previous</a>: <a href="Relations.scala.html#9878" title="sbt.inc.Relations">Relations</a>, <a title="sbt.inc.APIChanges[java.io.File]" id="138784">changes</a>: <a href="Changes.scala.html#9816" title="sbt.inc.APIChanges[java.io.File]">APIChanges</a><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="138785">recompiledSources</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Boolean" id="138786">transitive</a>: <span title="Boolean">Boolean</span>, <a title="sbt.Logger" id="138787">log</a>: <a href="Logger.scala.html#13103" title="sbt.Logger">Logger</a><span class="delimiter">)</span>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span> =
	<span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="java.io.File =&gt; Set[java.io.File]" id="139654">dependsOnSrc</a> = <a href="#138783" title="sbt.inc.Relations">previous</a>.<a href="Relations.scala.html#120884" title="(dep: java.io.File)Set[java.io.File]">usesInternalSrc</a> _
		<span class="keyword">val</span> <a title="Set[java.io.File]" id="139655">propagated</a> =
			<span title="Set[java.io.File]" class="keyword">if</span><span class="delimiter">(</span><a href="#138786" title="Boolean">transitive</a><span class="delimiter">)</span>
				<a href="#122697" title="(dependsOnSrc: java.io.File =&gt; Set[java.io.File], initial: Set[java.io.File], log: sbt.Logger)Set[java.io.File]">transitiveDependencies</a><span class="delimiter">(</span><a href="#139654" title="java.io.File =&gt; Set[java.io.File]">dependsOnSrc</a>, <a href="#138784" title="sbt.inc.APIChanges[java.io.File]">changes</a>.<a href="Changes.scala.html#122438" title="=&gt; Set[java.io.File]">modified</a>, <a href="#138787" title="sbt.Logger">log</a><span class="delimiter">)</span>
			<span class="keyword">else</span>
				<a href="#122698" title="(dependsOnSrc: java.io.File =&gt; Set[java.io.File], initial: Set[java.io.File], log: sbt.Logger)Set[java.io.File]">invalidateStage2</a><span class="delimiter">(</span><a href="#139654" title="java.io.File =&gt; Set[java.io.File]">dependsOnSrc</a>, <a href="#138784" title="sbt.inc.APIChanges[java.io.File]">changes</a>.<a href="Changes.scala.html#122438" title="=&gt; Set[java.io.File]">modified</a>, <a href="#138787" title="sbt.Logger">log</a><span class="delimiter">)</span>

		<span class="keyword">val</span> <a title="Set[java.io.File]" id="139656">dups</a> = <a href="#122694" title="(merged: sbt.inc.Relations)Set[java.io.File]">invalidateDuplicates</a><span class="delimiter">(</span><a href="#138783" title="sbt.inc.Relations">previous</a><span class="delimiter">)</span>
		<span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#139656" title="Set[java.io.File]">dups</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span>
			<a href="#138787" title="sbt.Logger">log</a>.<a href="Logger.scala.html#53760" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Invalidated due to generated class file collision: &quot;)" class="string">&quot;Invalidated due to generated class file collision: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#139656" title="Set[java.io.File]">dups</a><span class="delimiter">)</span>

		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="139657">inv</a> = <a href="#139655" title="Set[java.io.File]">propagated</a> <span title="(elems: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">++</span> <a href="#139656" title="Set[java.io.File]">dups</a> <span class="comment">// ++ scopeInvalidations(previous.extAPI _, changes.modified, changes.names)</span>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="139658">newlyInvalidated</a> = <a href="#139657" title="scala.collection.immutable.Set[java.io.File]">inv</a> <span title="(xs: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">--</span> <a href="#138785" title="Set[java.io.File]">recompiledSources</a>
		<span title="Set[java.io.File]" class="keyword">if</span><span class="delimiter">(</span><a href="#139658" title="scala.collection.immutable.Set[java.io.File]">newlyInvalidated</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <span title="=&gt; scala.collection.immutable.Set.type">Set</span>.<span title="scala.collection.immutable.Set[java.io.File]">empty</span> <span class="keyword">else</span> <a href="#139657" title="scala.collection.immutable.Set[java.io.File]">inv</a>
	<span class="delimiter">}</span>

	<span class="comment">/** Invalidate all sources that claim to produce the same class file as another source file. */</span>
	<span class="keyword">def</span> <a title="(merged: sbt.inc.Relations)Set[java.io.File]" id="122694">invalidateDuplicates</a><span class="delimiter">(</span><a title="sbt.inc.Relations" id="139669">merged</a>: <a href="Relations.scala.html#9878" title="sbt.inc.Relations">Relations</a><span class="delimiter">)</span>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span> =
		<a href="#139669" title="sbt.inc.Relations">merged</a>.<a href="Relations.scala.html#120893" title="=&gt; sbt.Relation[java.io.File,java.io.File]">srcProd</a>.<a href="Relation.scala.html#139743" title="=&gt; Map[java.io.File,Set[java.io.File]]">reverseMap</a>.<span title="(f: ((java.io.File, Set[java.io.File])) =&gt; scala.collection.GenTraversableOnce[java.io.File])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Map[java.io.File,Set[java.io.File]],java.io.File,scala.collection.immutable.Iterable[java.io.File]])scala.collection.immutable.Iterable[java.io.File]">flatMap</span> <a href="#139814" title="&lt;none&gt; extends scala.collection.immutable.Iterable[java.io.File] with java.io.File with Int =&gt; Boolean" class="delimiter">{</a> <span class="keyword">case</span> <span title="&lt;none&gt; extends scala.collection.immutable.Iterable[java.io.File] with java.io.File with Int =&gt; Boolean" class="delimiter">(</span><a title="java.io.File" id="139817">classFile</a>, <a title="Set[java.io.File]" id="139818">sources</a><span class="delimiter">)</span> =&gt;
			<span title="&lt;none&gt; extends scala.collection.immutable.Iterable[java.io.File] with java.io.File with Int =&gt; Boolean" class="keyword">if</span><span class="delimiter">(</span><a href="#139818" title="Set[java.io.File]">sources</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <a href="#139818" title="Set[java.io.File]">sources</a> <span class="keyword">else</span> <span title="object Nil">Nil</span>
		<span class="delimiter">}</span> <span title="scala.collection.immutable.Set[java.io.File]">toSet</span>;

	<span class="comment">/** Only invalidates direct source dependencies.  It excludes any sources that were recompiled during the previous run.
	* Callers may want to augment the returned set with 'modified' or all sources recompiled up to this point. */</span>
	<span class="keyword">def</span> <a title="(dependsOnSrc: java.io.File =&gt; Set[java.io.File], modified: Set[java.io.File])Set[java.io.File]" id="122695">invalidateDirect</a><span class="delimiter">(</span><a title="java.io.File =&gt; Set[java.io.File]" id="144818">dependsOnSrc</a>: File =&gt; Set<span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="144819">modified</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span> =
		<span class="delimiter">(</span><a href="#144819" title="Set[java.io.File]">modified</a> <span title="(f: java.io.File =&gt; scala.collection.GenTraversableOnce[java.io.File])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[java.io.File],java.io.File,scala.collection.immutable.Set[java.io.File]])scala.collection.immutable.Set[java.io.File]">flatMap</span> <a href="#144818" title="java.io.File =&gt; Set[java.io.File]">dependsOnSrc</a><span class="delimiter">)</span> <span title="(xs: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">--</span> <a href="#144819" title="Set[java.io.File]">modified</a>

	<span class="comment">/** Invalidates transitive source dependencies including `modified`.*/</span>
	@tailrec <span class="keyword">def</span> <a title="(dependsOnSrc: java.io.File =&gt; Set[java.io.File], modified: Set[java.io.File], log: sbt.Logger)Set[java.io.File]" id="122696">invalidateTransitive</a><span class="delimiter">(</span><a title="java.io.File =&gt; Set[java.io.File]" id="144865">dependsOnSrc</a>: File =&gt; Set<span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="144866">modified</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="sbt.Logger" id="144867">log</a>: <a href="Logger.scala.html#13103" title="sbt.Logger">Logger</a><span class="delimiter">)</span>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span> =
	<span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="Set[java.io.File]" id="144869">newInv</a> = <a href="#122695" title="(dependsOnSrc: java.io.File =&gt; Set[java.io.File], modified: Set[java.io.File])Set[java.io.File]">invalidateDirect</a><span class="delimiter">(</span><a href="#144865" title="java.io.File =&gt; Set[java.io.File]">dependsOnSrc</a>, <a href="#144866" title="Set[java.io.File]">modified</a><span class="delimiter">)</span>
		<a href="#144867" title="sbt.Logger">log</a>.<a href="Logger.scala.html#53760" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;\011Invalidated direct: &quot;)" class="string">&quot;\tInvalidated direct: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#144869" title="Set[java.io.File]">newInv</a><span class="delimiter">)</span>
		<span title="Set[java.io.File]" class="keyword">if</span><span class="delimiter">(</span><a href="#144869" title="Set[java.io.File]">newInv</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#144866" title="Set[java.io.File]">modified</a> <span class="keyword">else</span> <a href="#122696" title="(dependsOnSrc: java.io.File =&gt; Set[java.io.File], modified: Set[java.io.File], log: sbt.Logger)Set[java.io.File]">invalidateTransitive</a><span class="delimiter">(</span><a href="#144865" title="java.io.File =&gt; Set[java.io.File]">dependsOnSrc</a>, <a href="#144866" title="Set[java.io.File]">modified</a> <span title="(elems: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">++</span> <a href="#144869" title="Set[java.io.File]">newInv</a>, <a href="#144867" title="sbt.Logger">log</a><span class="delimiter">)</span>
	<span class="delimiter">}</span>

	<span class="comment">/** Returns the transitive source dependencies of `initial`, excluding the files in `initial` in most cases.
	* In three-stage incremental compilation, the `initial` files are the sources from step 2 that had API changes.
	* Because strongly connected components (cycles) are included in step 2, the files with API changes shouldn't 
	* need to be compiled in step 3 if their dependencies haven't changed.  If there are new cycles introduced after
	* step 2, these can require step 2 sources to be included in step 3 recompilation.
	*/</span>
	<span class="keyword">def</span> <a title="(dependsOnSrc: java.io.File =&gt; Set[java.io.File], initial: Set[java.io.File], log: sbt.Logger)Set[java.io.File]" id="122697">transitiveDependencies</a><span class="delimiter">(</span><a title="java.io.File =&gt; Set[java.io.File]" id="139661">dependsOnSrc</a>: File =&gt; Set<span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="139662">initial</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="sbt.Logger" id="139663">log</a>: <a href="Logger.scala.html#13103" title="sbt.Logger">Logger</a><span class="delimiter">)</span>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span> =
	<span class="delimiter">{</span>
		<span class="comment">// include any file that depends on included files</span>
		<span class="keyword">def</span> <a title="(included: Set[java.io.File], process: Set[java.io.File], excluded: Set[java.io.File])Set[java.io.File]" id="144919">recheck</a><span class="delimiter">(</span><a title="Set[java.io.File]" id="144922">included</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="144923">process</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="144924">excluded</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span> =
		<span class="delimiter">{</span>
			<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="144925">newIncludes</a> = <span class="delimiter">(</span><a href="#144923" title="Set[java.io.File]">process</a> <span title="(f: java.io.File =&gt; scala.collection.GenTraversableOnce[java.io.File])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[java.io.File],java.io.File,scala.collection.immutable.Set[java.io.File]])scala.collection.immutable.Set[java.io.File]">flatMap</span> <a href="#139661" title="java.io.File =&gt; Set[java.io.File]">dependsOnSrc</a><span class="delimiter">)</span> <span title="(that: scala.collection.GenSet[java.io.File])scala.collection.immutable.Set[java.io.File]">intersect</span> <a href="#144924" title="Set[java.io.File]">excluded</a>
			<span title="Set[java.io.File]" class="keyword">if</span><span class="delimiter">(</span><a href="#144925" title="scala.collection.immutable.Set[java.io.File]">newIncludes</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span>
				<a href="#144922" title="Set[java.io.File]">included</a>
			<span class="keyword">else</span>
				<a href="#144919" title="(included: Set[java.io.File], process: Set[java.io.File], excluded: Set[java.io.File])Set[java.io.File]">recheck</a><span class="delimiter">(</span><a href="#144922" title="Set[java.io.File]">included</a> <span title="(elems: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">++</span> <a href="#144925" title="scala.collection.immutable.Set[java.io.File]">newIncludes</a>, <a href="#144925" title="scala.collection.immutable.Set[java.io.File]">newIncludes</a>, <a href="#144924" title="Set[java.io.File]">excluded</a> <span title="(xs: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">--</span> <a href="#144925" title="scala.collection.immutable.Set[java.io.File]">newIncludes</a><span class="delimiter">)</span>
		<span class="delimiter">}</span>
		<span class="keyword">val</span> <a title="Set[java.io.File]" id="144920">transitiveOnly</a> = <a href="#122706" title="(nodes: Iterable[java.io.File])(dependencies: java.io.File =&gt; Iterable[java.io.File])Set[java.io.File]">transitiveDepsOnly</a><span class="delimiter">(</span><a href="#139662" title="Set[java.io.File]">initial</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#139661" title="java.io.File =&gt; Set[java.io.File]">dependsOnSrc</a><span class="delimiter">)</span>
		<a href="#139663" title="sbt.Logger">log</a>.<a href="Logger.scala.html#53760" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Step 3 transitive dependencies:\012\011&quot;)" class="string">&quot;Step 3 transitive dependencies:\n\t&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#144920" title="Set[java.io.File]">transitiveOnly</a><span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="Set[java.io.File]" id="144921">stage3</a> = <a href="#144919" title="(included: Set[java.io.File], process: Set[java.io.File], excluded: Set[java.io.File])Set[java.io.File]">recheck</a><span class="delimiter">(</span><a href="#144920" title="Set[java.io.File]">transitiveOnly</a>, <a href="#144920" title="Set[java.io.File]">transitiveOnly</a>, <a href="#139662" title="Set[java.io.File]">initial</a><span class="delimiter">)</span>
		<a href="#139663" title="sbt.Logger">log</a>.<a href="Logger.scala.html#53760" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Step 3 sources from new step 2 source dependencies:\012\011&quot;)" class="string">&quot;Step 3 sources from new step 2 source dependencies:\n\t&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <span class="delimiter">(</span><a href="#144921" title="Set[java.io.File]">stage3</a> <span title="(xs: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">--</span> <a href="#144920" title="Set[java.io.File]">transitiveOnly</a><span class="delimiter">)</span><span class="delimiter">)</span>
		<a href="#144921" title="Set[java.io.File]">stage3</a>
	<span class="delimiter">}</span>


	<span class="keyword">def</span> <a title="(dependsOnSrc: java.io.File =&gt; Set[java.io.File], initial: Set[java.io.File], log: sbt.Logger)Set[java.io.File]" id="122698">invalidateStage2</a><span class="delimiter">(</span><a title="java.io.File =&gt; Set[java.io.File]" id="139665">dependsOnSrc</a>: File =&gt; Set<span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="139666">initial</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="sbt.Logger" id="139667">log</a>: <a href="Logger.scala.html#13103" title="sbt.Logger">Logger</a><span class="delimiter">)</span>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span> =
	<span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="145043">initAndImmediate</a> = <a href="#139666" title="Set[java.io.File]">initial</a> <span title="(elems: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">++</span> <a href="#139666" title="Set[java.io.File]">initial</a>.<span title="(f: java.io.File =&gt; scala.collection.GenTraversableOnce[java.io.File])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[java.io.File],java.io.File,scala.collection.immutable.Set[java.io.File]])scala.collection.immutable.Set[java.io.File]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set.Coll,java.io.File,scala.collection.immutable.Set[java.io.File]]" class="delimiter">(</span><a href="#139665" title="java.io.File =&gt; Set[java.io.File]">dependsOnSrc</a><span class="delimiter">)</span>
		<a href="#139667" title="sbt.Logger">log</a>.<a href="Logger.scala.html#53760" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Step 2 changed sources and immdediate dependencies:\012\011&quot;)" class="string">&quot;Step 2 changed sources and immdediate dependencies:\n\t&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145043" title="scala.collection.immutable.Set[java.io.File]">initAndImmediate</a><span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="Set[Set[java.io.File]]" id="145044">components</a> = sbt.inc.<a href="StronglyConnected.scala.html#145135" title="(nodes: Iterable[java.io.File])(dependencies: java.io.File =&gt; Iterable[java.io.File])Set[Set[java.io.File]]">StronglyConnected</a><span class="delimiter">(</span><a href="#145043" title="scala.collection.immutable.Set[java.io.File]">initAndImmediate</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#139665" title="java.io.File =&gt; Set[java.io.File]">dependsOnSrc</a><span class="delimiter">)</span>
		<a href="#139667" title="sbt.Logger">log</a>.<a href="Logger.scala.html#53760" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Non-trivial strongly connected components: &quot;)" class="string">&quot;Non-trivial strongly connected components: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145044" title="Set[Set[java.io.File]]">components</a>.<span title="(p: Set[java.io.File] =&gt; Boolean)scala.collection.immutable.Set[Set[java.io.File]]">filter</span><span class="delimiter">(</span><a href="#145163" title="Set[java.io.File]">_</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="(start: String, sep: String, end: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;\012\011&quot;)" class="string">&quot;\n\t&quot;</span>, <span title="java.lang.String(&quot;\012\011&quot;)" class="string">&quot;\n\t&quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="145045">inv</a> = <a href="#145044" title="Set[Set[java.io.File]]">components</a>.<span title="(p: Set[java.io.File] =&gt; Boolean)scala.collection.immutable.Set[Set[java.io.File]]">filter</span><span class="delimiter">(</span><a href="#145043" title="scala.collection.immutable.Set[java.io.File]">initAndImmediate</a>.<a href="#145182" title="(p: java.io.File =&gt; Boolean)Boolean">exists</a><span class="delimiter">)</span>.<span title="(implicit asTraversable: Set[java.io.File] =&gt; scala.collection.TraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">flatten</span>
		<a href="#139667" title="sbt.Logger">log</a>.<a href="Logger.scala.html#53760" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Step 2 invalidated sources:\012\011&quot;)" class="string">&quot;Step 2 invalidated sources:\n\t&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145045" title="scala.collection.immutable.Set[java.io.File]">inv</a><span class="delimiter">)</span>
		<a href="#145045" title="scala.collection.immutable.Set[java.io.File]">inv</a>
	<span class="delimiter">}</span>

	<span class="comment">/** Invalidates sources based on initially detected 'changes' to the sources, products, and dependencies.*/</span>
	<span class="keyword">def</span> <a title="(previous: sbt.inc.Relations, changes: sbt.inc.InitialChanges, log: sbt.Logger)Set[java.io.File]" id="122699">invalidateInitial</a><span class="delimiter">(</span><a title="sbt.inc.Relations" id="138662">previous</a>: <a href="Relations.scala.html#9878" title="sbt.inc.Relations">Relations</a>, <a title="sbt.inc.InitialChanges" id="138663">changes</a>: <a href="Changes.scala.html#9813" title="sbt.inc.InitialChanges">InitialChanges</a>, <a title="sbt.Logger" id="138664">log</a>: <a href="Logger.scala.html#13103" title="sbt.Logger">Logger</a><span class="delimiter">)</span>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span> =
	<span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="sbt.inc.Changes[java.io.File]" id="145225">srcChanges</a> = <a href="#138663" title="sbt.inc.InitialChanges">changes</a>.<a href="Changes.scala.html#122417" title="=&gt; sbt.inc.Changes[java.io.File]">internalSrc</a>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="145226">srcDirect</a> = <a href="#145225" title="sbt.inc.Changes[java.io.File]">srcChanges</a>.<a href="Changes.scala.html#122433" title="=&gt; Set[java.io.File]">removed</a> <span title="(elems: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">++</span> <a href="#145225" title="sbt.inc.Changes[java.io.File]">srcChanges</a>.<a href="Changes.scala.html#122433" title="=&gt; Set[java.io.File]">removed</a>.<span title="(f: java.io.File =&gt; scala.collection.GenTraversableOnce[java.io.File])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[java.io.File],java.io.File,scala.collection.immutable.Set[java.io.File]])scala.collection.immutable.Set[java.io.File]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set.Coll,java.io.File,scala.collection.immutable.Set[java.io.File]]" class="delimiter">(</span><a href="#138662" title="sbt.inc.Relations">previous</a>.<a href="Relations.scala.html#120884" title="(dep: java.io.File)Set[java.io.File]">usesInternalSrc</a><span class="delimiter">)</span> <span title="(elems: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">++</span> <a href="#145225" title="sbt.inc.Changes[java.io.File]">srcChanges</a>.<a href="Changes.scala.html#122432" title="=&gt; Set[java.io.File]">added</a> <span title="(elems: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">++</span> <a href="#145225" title="sbt.inc.Changes[java.io.File]">srcChanges</a>.<a href="Changes.scala.html#122434" title="=&gt; Set[java.io.File]">changed</a>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="145227">byProduct</a> = <a href="#138663" title="sbt.inc.InitialChanges">changes</a>.<a href="Changes.scala.html#122419" title="=&gt; Set[java.io.File]">removedProducts</a>.<span title="(f: java.io.File =&gt; scala.collection.GenTraversableOnce[java.io.File])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[java.io.File],java.io.File,scala.collection.immutable.Set[java.io.File]])scala.collection.immutable.Set[java.io.File]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set.Coll,java.io.File,scala.collection.immutable.Set[java.io.File]]" class="delimiter">(</span><a href="#138662" title="sbt.inc.Relations">previous</a>.<a href="Relations.scala.html#120880" title="(prod: java.io.File)Set[java.io.File]">produced</a><span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="145228">byBinaryDep</a> = <a href="#138663" title="sbt.inc.InitialChanges">changes</a>.<a href="Changes.scala.html#122421" title="=&gt; Set[java.io.File]">binaryDeps</a>.<span title="(f: java.io.File =&gt; scala.collection.GenTraversableOnce[java.io.File])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[java.io.File],java.io.File,scala.collection.immutable.Set[java.io.File]])scala.collection.immutable.Set[java.io.File]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set.Coll,java.io.File,scala.collection.immutable.Set[java.io.File]]" class="delimiter">(</span><a href="#138662" title="sbt.inc.Relations">previous</a>.<a href="Relations.scala.html#120882" title="(dep: java.io.File)Set[java.io.File]">usesBinary</a><span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="145229">byExtSrcDep</a> = <a href="#138663" title="sbt.inc.InitialChanges">changes</a>.<a href="Changes.scala.html#122423" title="=&gt; sbt.inc.APIChanges[String]">external</a>.<a href="Changes.scala.html#122438" title="=&gt; Set[String]">modified</a>.<span title="(f: String =&gt; scala.collection.GenTraversableOnce[java.io.File])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[String],java.io.File,scala.collection.immutable.Set[java.io.File]])scala.collection.immutable.Set[java.io.File]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set.Coll,java.io.File,scala.collection.immutable.Set[java.io.File]]" class="delimiter">(</span><a href="#138662" title="sbt.inc.Relations">previous</a>.<a href="Relations.scala.html#120886" title="(dep: String)Set[java.io.File]">usesExternal</a><span class="delimiter">)</span> <span class="comment">// ++ scopeInvalidations</span>
		<a href="#138664" title="sbt.Logger">log</a>.<a href="Logger.scala.html#53760" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span>
			<span title="java.lang.String(&quot;\012Initial source changes: \012\011removed:&quot;)" class="string">&quot;\nInitial source changes: \n\tremoved:&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145225" title="sbt.inc.Changes[java.io.File]">srcChanges</a>.<a href="Changes.scala.html#122433" title="=&gt; Set[java.io.File]">removed</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\012\011added: &quot;)" class="string">&quot;\n\tadded: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145225" title="sbt.inc.Changes[java.io.File]">srcChanges</a>.<a href="Changes.scala.html#122432" title="=&gt; Set[java.io.File]">added</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\012\011modified: &quot;)" class="string">&quot;\n\tmodified: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145225" title="sbt.inc.Changes[java.io.File]">srcChanges</a>.<a href="Changes.scala.html#122434" title="=&gt; Set[java.io.File]">changed</a> <span title="(x$1: Any)java.lang.String">+</span>
			<span title="java.lang.String(&quot;\012Removed products: &quot;)" class="string">&quot;\nRemoved products: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#138663" title="sbt.inc.InitialChanges">changes</a>.<a href="Changes.scala.html#122419" title="=&gt; Set[java.io.File]">removedProducts</a> <span title="(x$1: Any)java.lang.String">+</span>
			<span title="java.lang.String(&quot;\012Modified external sources: &quot;)" class="string">&quot;\nModified external sources: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#138663" title="sbt.inc.InitialChanges">changes</a>.<a href="Changes.scala.html#122423" title="=&gt; sbt.inc.APIChanges[String]">external</a>.<a href="Changes.scala.html#122438" title="=&gt; Set[String]">modified</a> <span title="(x$1: Any)java.lang.String">+</span>
			<span title="java.lang.String(&quot;\012Modified binary dependencies: &quot;)" class="string">&quot;\nModified binary dependencies: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#138663" title="sbt.inc.InitialChanges">changes</a>.<a href="Changes.scala.html#122421" title="=&gt; Set[java.io.File]">binaryDeps</a> <span title="(x$1: Any)java.lang.String">+</span>
			<span title="java.lang.String(&quot;\012Initial directly invalidated sources: &quot;)" class="string">&quot;\nInitial directly invalidated sources: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145226" title="scala.collection.immutable.Set[java.io.File]">srcDirect</a> <span title="(x$1: Any)java.lang.String">+</span>
			<span title="java.lang.String(&quot;\012\012Sources indirectly invalidated by:&quot;)" class="string">&quot;\n\nSources indirectly invalidated by:&quot;</span> <span title="(x$1: Any)java.lang.String">+</span>
			<span title="java.lang.String(&quot;\012\011product: &quot;)" class="string">&quot;\n\tproduct: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145227" title="scala.collection.immutable.Set[java.io.File]">byProduct</a> <span title="(x$1: Any)java.lang.String">+</span>
			<span title="java.lang.String(&quot;\012\011binary dep: &quot;)" class="string">&quot;\n\tbinary dep: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145228" title="scala.collection.immutable.Set[java.io.File]">byBinaryDep</a> <span title="(x$1: Any)java.lang.String">+</span>
			<span title="java.lang.String(&quot;\012\011external source: &quot;)" class="string">&quot;\n\texternal source: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145229" title="scala.collection.immutable.Set[java.io.File]">byExtSrcDep</a>
		<span class="delimiter">)</span>

		<a href="#145226" title="scala.collection.immutable.Set[java.io.File]">srcDirect</a> <span title="(elems: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">++</span> <a href="#145227" title="scala.collection.immutable.Set[java.io.File]">byProduct</a> <span title="(elems: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">++</span> <a href="#145228" title="scala.collection.immutable.Set[java.io.File]">byBinaryDep</a> <span title="(elems: scala.collection.GenTraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">++</span> <a href="#145229" title="scala.collection.immutable.Set[java.io.File]">byExtSrcDep</a>
	<span class="delimiter">}</span>

	<span class="keyword">def</span> <a title="(invalidatedSrcs: Set[java.io.File], previous: sbt.inc.Analysis)sbt.inc.Analysis" id="122700">prune</a><span class="delimiter">(</span><a title="Set[java.io.File]" id="138752">invalidatedSrcs</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="sbt.inc.Analysis" id="138753">previous</a>: <a href="Analysis.scala.html#9798" title="sbt.inc.Analysis">Analysis</a><span class="delimiter">)</span>: <a href="Analysis.scala.html#9798" title="sbt.inc.Analysis">Analysis</a> =
	<span class="delimiter">{</span>
		<a href="IO.scala.html#12904" title="object sbt.IO">IO</a>.<a href="IO.scala.html#31772" title="(files: Iterable[java.io.File])Unit">deleteFilesEmptyDirs</a><span class="delimiter">(</span> <a href="#138752" title="Set[java.io.File]">invalidatedSrcs</a>.<span title="(f: java.io.File =&gt; scala.collection.GenTraversableOnce[java.io.File])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[java.io.File],java.io.File,Iterable[java.io.File]])Iterable[java.io.File]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set.Coll,java.io.File,scala.collection.immutable.Set[java.io.File]]" class="delimiter">(</span><a href="#138753" title="sbt.inc.Analysis">previous</a>.<a href="Analysis.scala.html#120837" title="=&gt; sbt.inc.Relations">relations</a>.<a href="Relations.scala.html#120879" title="(src: java.io.File)Set[java.io.File]">products</a><span class="delimiter">)</span> <span class="delimiter">)</span>
		<a href="#138753" title="sbt.inc.Analysis">previous</a> <a href="Analysis.scala.html#120840" title="(sources: Iterable[java.io.File])sbt.inc.Analysis">--</a> <a href="#138752" title="Set[java.io.File]">invalidatedSrcs</a>
	<span class="delimiter">}</span>

	<span class="comment">// for binary compatibility in 0.12.x</span>
	<span class="keyword">def</span> <a title="(entry: String =&gt; Option[java.io.File], analysis: java.io.File =&gt; Option[sbt.inc.Analysis], previous: sbt.inc.Stamps, current: sbt.inc.ReadStamps)(implicit equivS: Equiv[sbt.inc.Stamp])java.io.File =&gt; Boolean" id="122701">externalBinaryModified</a><span class="delimiter">(</span><a title="String =&gt; Option[java.io.File]" id="139576">entry</a>: String =&gt; Option<span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="java.io.File =&gt; Option[sbt.inc.Analysis]" id="139577">analysis</a>: File =&gt; Option<span class="delimiter">[</span>Analysis<span class="delimiter">]</span>, <a title="sbt.inc.Stamps" id="139578">previous</a>: <a href="Stamp.scala.html#9899" title="sbt.inc.Stamps">Stamps</a>, <a title="sbt.inc.ReadStamps" id="139579">current</a>: <a href="Stamp.scala.html#9898" title="sbt.inc.ReadStamps">ReadStamps</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Equiv[sbt.inc.Stamp]" id="139580">equivS</a>: <span title="Equiv[sbt.inc.Stamp]">Equiv</span><span class="delimiter">[</span>Stamp<span class="delimiter">]</span><span class="delimiter">)</span>: File =&gt; Boolean =
		<a href="#122702" title="(entry: String =&gt; Option[java.io.File], analysis: java.io.File =&gt; Option[sbt.inc.Analysis], previous: sbt.inc.Stamps, current: sbt.inc.ReadStamps, log: sbt.Logger)(implicit equivS: Equiv[sbt.inc.Stamp])java.io.File =&gt; Boolean">externalBinaryModified</a><span class="delimiter">(</span><a href="#139576" title="String =&gt; Option[java.io.File]">entry</a>, <a href="#139577" title="java.io.File =&gt; Option[sbt.inc.Analysis]">analysis</a>, <a href="#139578" title="sbt.inc.Stamps">previous</a>, <a href="#139579" title="sbt.inc.ReadStamps">current</a>, <a href="Logger.scala.html#13101" title="object sbt.Logger">Logger</a>.<a href="Logger.scala.html#54047" title="=&gt; sbt.AbstractLogger">Null</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#139580" title="Equiv[sbt.inc.Stamp]">equivS</a><span class="delimiter">)</span>

	<span class="keyword">def</span> <a title="(entry: String =&gt; Option[java.io.File], analysis: java.io.File =&gt; Option[sbt.inc.Analysis], previous: sbt.inc.Stamps, current: sbt.inc.ReadStamps, log: sbt.Logger)(implicit equivS: Equiv[sbt.inc.Stamp])java.io.File =&gt; Boolean" id="122702">externalBinaryModified</a><span class="delimiter">(</span><a title="String =&gt; Option[java.io.File]" id="139569">entry</a>: String =&gt; Option<span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="java.io.File =&gt; Option[sbt.inc.Analysis]" id="139570">analysis</a>: File =&gt; Option<span class="delimiter">[</span>Analysis<span class="delimiter">]</span>, <a title="sbt.inc.Stamps" id="139571">previous</a>: <a href="Stamp.scala.html#9899" title="sbt.inc.Stamps">Stamps</a>, <a title="sbt.inc.ReadStamps" id="139572">current</a>: <a href="Stamp.scala.html#9898" title="sbt.inc.ReadStamps">ReadStamps</a>, <a title="sbt.Logger" id="139573">log</a>: <a href="Logger.scala.html#13103" title="sbt.Logger">Logger</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Equiv[sbt.inc.Stamp]" id="139574">equivS</a>: <span title="Equiv[sbt.inc.Stamp]">Equiv</span><span class="delimiter">[</span>Stamp<span class="delimiter">]</span><span class="delimiter">)</span>: File =&gt; Boolean =
		<a title="java.io.File" id="145755">dependsOn</a> =&gt;
		<span class="delimiter">{</span>
			<span class="keyword">def</span> <a title="(reason: String)Boolean" id="145756">inv</a><span class="delimiter">(</span><a title="String" id="145760">reason</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
				<a href="#139573" title="sbt.Logger">log</a>.<a href="Logger.scala.html#53760" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Invalidating &quot;)" class="string">&quot;Invalidating &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145755" title="java.io.File">dependsOn</a>.<span title="()java.lang.String">getCanonicalPath</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145760" title="String">reason</a><span class="delimiter">)</span>
				<span title="Boolean(true)" class="keyword">true</span>
			<span class="delimiter">}</span>
			<span class="keyword">def</span> <a title="(className: String, classpathEntry: java.io.File)Boolean" id="145757">entryModified</a><span class="delimiter">(</span><a title="String" id="145765">className</a>: <span title="String">String</span>, <a title="java.io.File" id="145766">classpathEntry</a>: <span title="java.io.File">File</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> =
			<span class="delimiter">{</span>
				<span class="keyword">val</span> <a title="java.io.File" id="145767">resolved</a> = <a href="Locate.scala.html#9871" title="object sbt.inc.Locate">Locate</a>.<a href="Locate.scala.html#122821" title="(f: java.io.File, className: String)java.io.File">resolve</a><span class="delimiter">(</span><a href="#145766" title="java.io.File">classpathEntry</a>, <a href="#145765" title="String">className</a><span class="delimiter">)</span>
				<span title="Boolean" class="keyword">if</span><span class="delimiter">(</span><a href="#145767" title="java.io.File">resolved</a>.<span title="()java.lang.String">getCanonicalPath</span> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#145755" title="java.io.File">dependsOn</a>.<span title="()java.lang.String">getCanonicalPath</span><span class="delimiter">)</span>
					<a href="#145756" title="(reason: String)Boolean">inv</a><span class="delimiter">(</span><span title="java.lang.String(&quot;class &quot;)" class="string">&quot;class &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145765" title="String">className</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; now provided by &quot;)" class="string">&quot; now provided by &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145767" title="java.io.File">resolved</a>.<span title="()java.lang.String">getCanonicalPath</span><span class="delimiter">)</span>
				<span class="keyword">else</span>
					<a href="#145758" title="(previousFile: java.io.File, currentFile: java.io.File)Boolean">fileModified</a><span class="delimiter">(</span><a href="#145755" title="java.io.File">dependsOn</a>, <a href="#145767" title="java.io.File">resolved</a><span class="delimiter">)</span>
			<span class="delimiter">}</span>
			<span class="keyword">def</span> <a title="(previousFile: java.io.File, currentFile: java.io.File)Boolean" id="145758">fileModified</a><span class="delimiter">(</span><a title="java.io.File" id="145773">previousFile</a>: <span title="java.io.File">File</span>, <a title="java.io.File" id="145774">currentFile</a>: <span title="java.io.File">File</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> =
			<span class="delimiter">{</span>
				<span class="keyword">val</span> <a title="sbt.inc.Stamp" id="145775">previousStamp</a> = <a href="#139571" title="sbt.inc.Stamps">previous</a>.<a href="Stamp.scala.html#120858" title="(bin: java.io.File)sbt.inc.Stamp">binary</a><span class="delimiter">(</span><a href="#145773" title="java.io.File">previousFile</a><span class="delimiter">)</span>
				<span class="keyword">val</span> <a title="sbt.inc.Stamp" id="145776">currentStamp</a> = <a href="#139572" title="sbt.inc.ReadStamps">current</a>.<a href="Stamp.scala.html#120858" title="(bin: java.io.File)sbt.inc.Stamp">binary</a><span class="delimiter">(</span><a href="#145774" title="java.io.File">currentFile</a><span class="delimiter">)</span>
				<span title="Boolean" class="keyword">if</span><span class="delimiter">(</span><a href="#139574" title="Equiv[sbt.inc.Stamp]">equivS</a>.<span title="(x: sbt.inc.Stamp, y: sbt.inc.Stamp)Boolean">equiv</span><span class="delimiter">(</span><a href="#145775" title="sbt.inc.Stamp">previousStamp</a>, <a href="#145776" title="sbt.inc.Stamp">currentStamp</a><span class="delimiter">)</span><span class="delimiter">)</span>
					<span title="Boolean(false)" class="keyword">false</span>
				<span class="keyword">else</span>
					<a href="#145756" title="(reason: String)Boolean">inv</a><span class="delimiter">(</span><span title="java.lang.String(&quot;stamp changed from &quot;)" class="string">&quot;stamp changed from &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145775" title="sbt.inc.Stamp">previousStamp</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; to &quot;)" class="string">&quot; to &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145776" title="sbt.inc.Stamp">currentStamp</a><span class="delimiter">)</span>
			<span class="delimiter">}</span>
			<span class="keyword">def</span> <a title="(file: java.io.File)Boolean" id="145759">dependencyModified</a><span class="delimiter">(</span><a title="java.io.File" id="145779">file</a>: <span title="java.io.File">File</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> =
				<a href="#139571" title="sbt.inc.Stamps">previous</a>.<a href="Stamp.scala.html#120866" title="(bin: java.io.File)Option[String]">className</a><span class="delimiter">(</span><a href="#145779" title="java.io.File">file</a><span class="delimiter">)</span> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
					<span class="keyword">case</span> <span title="Boolean">None</span> =&gt; <a href="#145756" title="(reason: String)Boolean">inv</a><span class="delimiter">(</span><span title="java.lang.String(&quot;no class name was mapped for it.&quot;)" class="string">&quot;no class name was mapped for it.&quot;</span><span class="delimiter">)</span>
					<span class="keyword">case</span> <span title="Boolean">Some</span><span class="delimiter">(</span><a title="String" id="145783">name</a><span class="delimiter">)</span> =&gt; <a href="#139569" title="(v1: String)Option[java.io.File]">entry</a><span class="delimiter">(</span><a href="#145783" title="String">name</a><span class="delimiter">)</span> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
						<span class="keyword">case</span> <span title="Boolean">None</span> =&gt; <a href="#145756" title="(reason: String)Boolean">inv</a><span class="delimiter">(</span><span title="java.lang.String(&quot;could not find class &quot;)" class="string">&quot;could not find class &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#145783" title="String">name</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; on the classpath.&quot;)" class="string">&quot; on the classpath.&quot;</span><span class="delimiter">)</span>
						<span class="keyword">case</span> <span title="Boolean">Some</span><span class="delimiter">(</span><a title="java.io.File" id="145786">e</a><span class="delimiter">)</span> =&gt; <a href="#145757" title="(className: String, classpathEntry: java.io.File)Boolean">entryModified</a><span class="delimiter">(</span><a href="#145783" title="String">name</a>, <a href="#145786" title="java.io.File">e</a><span class="delimiter">)</span>
					<span class="delimiter">}</span>
				<span class="delimiter">}</span>

			<a href="#139570" title="(v1: java.io.File)Option[sbt.inc.Analysis]">analysis</a><span class="delimiter">(</span><a href="#145755" title="java.io.File">dependsOn</a><span class="delimiter">)</span>.<span title="=&gt; Boolean">isEmpty</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span>
				<span class="delimiter">(</span><span title="Boolean" class="keyword">if</span><span class="delimiter">(</span><a href="#122677" title="=&gt; Boolean">skipClasspathLookup</a><span class="delimiter">)</span> <a href="#145758" title="(previousFile: java.io.File, currentFile: java.io.File)Boolean">fileModified</a><span class="delimiter">(</span><a href="#145755" title="java.io.File">dependsOn</a>, <a href="#145755" title="java.io.File">dependsOn</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#145759" title="(file: java.io.File)Boolean">dependencyModified</a><span class="delimiter">(</span><a href="#145755" title="java.io.File">dependsOn</a><span class="delimiter">)</span><span class="delimiter">)</span>

		<span class="delimiter">}</span>

	<span class="keyword">def</span> <a title="(entry: String =&gt; Option[java.io.File], forEntry: java.io.File =&gt; Option[sbt.inc.Analysis])String =&gt; xsbti.api.Source" id="122703">currentExternalAPI</a><span class="delimiter">(</span><a title="String =&gt; Option[java.io.File]" id="139596">entry</a>: String =&gt; Option<span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="java.io.File =&gt; Option[sbt.inc.Analysis]" id="139597">forEntry</a>: File =&gt; Option<span class="delimiter">[</span>Analysis<span class="delimiter">]</span><span class="delimiter">)</span>: String =&gt; Source =
		<a title="String" id="145789">className</a> =&gt;
			<a href="#122704" title="(o: Option[xsbti.api.Source])xsbti.api.Source">orEmpty</a><span class="delimiter">(</span>
				<span class="keyword">for</span> <span class="delimiter">{</span>
					<a title="java.io.File" id="145796">e</a> &lt;- <a href="#139596" title="(v1: String)Option[java.io.File]">entry</a><span title="(f: java.io.File =&gt; Option[xsbti.api.Source])Option[xsbti.api.Source]" class="delimiter">(</span><a href="#145789" title="String">className</a><span class="delimiter">)</span>
					<a title="sbt.inc.Analysis" id="145802">analysis</a> &lt;- <a href="#139597" title="(v1: java.io.File)Option[sbt.inc.Analysis]">forEntry</a><span title="(f: sbt.inc.Analysis =&gt; Option[xsbti.api.Source])Option[xsbti.api.Source]" class="delimiter">(</span><a href="#145796" title="java.io.File">e</a><span class="delimiter">)</span>
					<a title="java.io.File" id="145807">src</a> &lt;- <a href="#145802" title="sbt.inc.Analysis">analysis</a>.<a href="Analysis.scala.html#120837" title="=&gt; sbt.inc.Relations">relations</a>.<a href="Relations.scala.html#120878" title="(name: String)Set[java.io.File]">definesClass</a><span class="delimiter">(</span><a href="#145789" title="String">className</a><span class="delimiter">)</span>.<span title="(f: java.io.File =&gt; xsbti.api.Source)Option[xsbti.api.Source]">headOption</span>
				<span class="delimiter">}</span> <span class="keyword">yield</span>
					<a href="#145802" title="sbt.inc.Analysis">analysis</a>.<a href="Analysis.scala.html#120836" title="=&gt; sbt.inc.APIs">apis</a>.<a href="APIs.scala.html#120352" title="(src: java.io.File)xsbti.api.Source">internalAPI</a><span class="delimiter">(</span><a href="#145807" title="java.io.File">src</a><span class="delimiter">)</span>
			<span class="delimiter">)</span>

	<span class="keyword">def</span> <a title="(o: Option[xsbti.api.Source])xsbti.api.Source" id="122704">orEmpty</a><span class="delimiter">(</span><a title="Option[xsbti.api.Source]" id="145790">o</a>: <span title="Option[xsbti.api.Source]">Option</span><span class="delimiter">[</span>Source<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="xsbti/api/Source.java.html#10438" title="xsbti.api.Source">Source</a> = <a href="#145790" title="Option[xsbti.api.Source]">o</a> <span title="(default: =&gt; xsbti.api.Source)xsbti.api.Source">getOrElse</span> <a href="APIs.scala.html#9789" title="object sbt.inc.APIs">APIs</a>.<a href="APIs.scala.html#120347" title="=&gt; xsbti.api.Source">emptySource</a>
	<span class="keyword">def</span> <a title="(o: Option[Boolean])Boolean" id="122705">orTrue</a><span class="delimiter">(</span><a title="Option[Boolean]" id="145816">o</a>: <span title="Option[Boolean]">Option</span><span class="delimiter">[</span>Boolean<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#145816" title="Option[Boolean]">o</a> <span title="(default: =&gt; Boolean)Boolean">getOrElse</span> <span title="Boolean(true)" class="keyword">true</span>

	<span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="[T](nodes: Iterable[T])(dependencies: T =&gt; Iterable[T])Set[T]" id="122706">transitiveDepsOnly</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="122708">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Iterable[T]" id="145016">nodes</a>: <span title="Iterable[T]">Iterable</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="T =&gt; Iterable[T]" id="145017">dependencies</a>: T =&gt; Iterable<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Set[T]">Set</span><span class="delimiter">[</span>T<span class="delimiter">]</span> =
	<span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[T]" id="145823">xs</a> = <span title="()scala.collection.mutable.HashSet[T]" class="keyword">new</span> collection.mutable.<span title="scala.collection.mutable.HashSet[T]">HashSet</span><span class="delimiter">[</span>T<span class="delimiter">]</span>
		<span class="keyword">def</span> <a title="(ns: Iterable[T])Unit" id="145824">all</a><span class="delimiter">(</span><a title="Iterable[T]" id="145827">ns</a>: <span title="Iterable[T]">Iterable</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#145827" title="Iterable[T]">ns</a>.<span title="(f: T =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#145825" title="(n: T)Unit">visit</a><span class="delimiter">)</span>
		<span class="keyword">def</span> <a title="(n: T)Unit" id="145825">visit</a><span class="delimiter">(</span><a title="T" id="145846">n</a>: <a href="#122708" title="T">T</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
			<span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#145823" title="scala.collection.mutable.HashSet[T]">xs</a>.<span title="(elem: T)Boolean">contains</span><span class="delimiter">(</span><a href="#145846" title="T">n</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
				<a href="#145823" title="scala.collection.mutable.HashSet[T]">xs</a> <span title="(elem: T)xs.type">+=</span> <a href="#145846" title="T">n</a>
				<a href="#145824" title="(ns: Iterable[T])Unit">all</a><span class="delimiter">(</span><a href="#145017" title="(v1: T)Iterable[T]">dependencies</a><span class="delimiter">(</span><a href="#145846" title="T">n</a><span class="delimiter">)</span><span class="delimiter">)</span>
			<span class="delimiter">}</span>
		<a href="#145824" title="(ns: Iterable[T])Unit">all</a><span class="delimiter">(</span><a href="#145016" title="Iterable[T]">nodes</a><span class="delimiter">)</span>
		<a href="#145823" title="scala.collection.mutable.HashSet[T]">xs</a> <span title="(xs: scala.collection.TraversableOnce[T])xs.type">--=</span> <a href="#145016" title="Iterable[T]">nodes</a>
		<a href="#145823" title="scala.collection.mutable.HashSet[T]">xs</a>.<span title="scala.collection.immutable.Set[T]">toSet</span>
	<span class="delimiter">}</span>


	<span class="comment">// unmodifiedSources should not contain any sources in the previous compilation run</span>
	<span class="comment">//  (this may unnecessarily invalidate them otherwise)</span>
	<span class="comment">/*def scopeInvalidation(previous: Analysis, otherSources: Set[File], names: NameChanges): Set[File] =
	{
		val newNames = newTypes ++ names.newTerms
		val newMap = pkgNameMap(newNames)
		otherSources filter { src =&gt; scopeAffected(previous.extAPI(src), previous.srcDependencies(src), newNames, newMap) }
	}

	def scopeAffected(api: Source, srcDependencies: Iterable[Source], newNames: Set[String], newMap: Map[String, List[String]]): Boolean =
		collisions_?(TopLevel.names(api.definitions), newNames) ||
			pkgs(api) exists {p =&gt; shadowed_?(p, srcDependencies, newMap) }

	def collisions_?(existing: Set[String], newNames: Map[String, List[String]]): Boolean =
		!(existing ** newNames).isEmpty

	// A proper implementation requires the actual symbol names used.  This is a crude approximation in the meantime.
	def shadowed_?(fromPkg: List[String], srcDependencies: Iterable[Source], newNames: Map[String, List[String]]): Boolean =
	{
		lazy val newPN = newNames.filter { pn =&gt; properSubPkg(fromPkg, pn._2) }

		def isShadowed(usedName: String): Boolean =
		{
			val (usedPkg, name) = pkgAndName(usedName)
			newPN.get(name).forall { nPkg =&gt; properSubPkg(usedPkg, nPkg) }
		}

		val usedNames = TopLevel.names(srcDependencies) // conservative approximation of referenced top-level names
		usedNames exists isShadowed
	}
	def pkgNameMap(names: Iterable[String]): Map[String, List[String]] =
		(names map pkgAndName).toMap
	def pkgAndName(s: String) =
	{
		val period = s.lastIndexOf('.')
		if(period &lt; 0) (Nil, s) else (s.substring(0, period).split(&quot;\\.&quot;), s.substring(period+1))
	}
	def pkg(s: String) = pkgAndName(s)._1
	def properSubPkg(testParent: Seq[String], testSub: Seq[String]) = testParent.length &lt; testSub.length &amp;&amp; testSub.startsWith(testParent)
	def pkgs(api: Source) = names(api :: Nil).map(pkg)*/</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>