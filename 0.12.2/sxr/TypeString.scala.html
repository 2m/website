<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>TypeString.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> sbt.complete

	<span class="keyword">import</span> <a href="Parsers.scala.html#12753" title="object sbt.complete.DefaultParsers">DefaultParsers</a>._
	<span class="keyword">import</span> <a href="#12773" title="object sbt.complete.TypeString">TypeString</a>._

<span class="comment">/** Basic representation of types parsed from Manifest.toString.
* This can only represent the structure of parameterized types.
* All other types are represented by a TypeString with an empty `args`. */</span>
<span class="keyword">private</span><span class="delimiter">[</span>sbt<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">class</span> <a title="class TypeString extends java.lang.Object with ScalaObject" id="12772">TypeString</a><a href="#12772" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="String" id="2172568">base</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="List[sbt.complete.TypeString]" id="2172569">args</a>: <span title="List[sbt.complete.TypeString]">List</span><span class="delimiter">[</span>TypeString<span class="delimiter">]</span><span class="delimiter">)</span>
<span class="delimiter">{</span>
	<span class="keyword">override</span> <span class="keyword">def</span> <a title="()java.lang.String" id="2172564">toString</a> =
		<span title="java.lang.String" class="keyword">if</span><span class="delimiter">(</span><a href="#2172568" title="=&gt; String">base</a>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;scala.Function&quot;)">FunctionName</span><span class="delimiter">)</span><span class="delimiter">)</span>
			<a href="#2172569" title="=&gt; List[sbt.complete.TypeString]">args</a>.<span title="(n: Int)List[sbt.complete.TypeString]">dropRight</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="(start: String, sep: String, end: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;(&quot;)" class="string">&quot;(&quot;</span>, <span title="java.lang.String(&quot;,&quot;)" class="string">&quot;,&quot;</span>, <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; =&gt; &quot;)" class="string">&quot; =&gt; &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#2172569" title="=&gt; List[sbt.complete.TypeString]">args</a>.<span title="=&gt; sbt.complete.TypeString">last</span>
		<span class="keyword">else</span> <span title="java.lang.String" class="keyword">if</span><span class="delimiter">(</span><a href="#2172568" title="=&gt; String">base</a>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;scala.Tuple&quot;)">TupleName</span><span class="delimiter">)</span><span class="delimiter">)</span>
			<a href="#2172569" title="=&gt; List[sbt.complete.TypeString]">args</a>.<span title="(start: String, sep: String, end: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;(&quot;)" class="string">&quot;(&quot;</span>,<span title="java.lang.String(&quot;,&quot;)" class="string">&quot;,&quot;</span>,<span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span><span class="delimiter">)</span>
		<span class="keyword">else</span>
			<a href="#1233859" title="(base: String)String">cleanupTypeName</a><span class="delimiter">(</span><a href="#2172568" title="=&gt; String">base</a><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span class="delimiter">(</span><span title="Any" class="keyword">if</span><span class="delimiter">(</span><a href="#2172569" title="=&gt; List[sbt.complete.TypeString]">args</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span> <span class="keyword">else</span> <a href="#2172569" title="=&gt; List[sbt.complete.TypeString]">args</a>.<span title="(start: String, sep: String, end: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;[&quot;)" class="string">&quot;[&quot;</span>, <span title="java.lang.String(&quot;,&quot;)" class="string">&quot;,&quot;</span>, <span title="java.lang.String(&quot;]&quot;)" class="string">&quot;]&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">private</span><span class="delimiter">[</span>sbt<span class="delimiter">]</span> <span class="keyword">object</span> <a title="object sbt.complete.TypeString" id="12773">TypeString</a>
<span title="ScalaObject" class="delimiter">{</span>
	<span class="comment">/** Makes the string representation of a type as returned by Manifest.toString more readable.*/</span>
	<span class="keyword">def</span> <a title="(typeString: String)String" id="1233858">cleanup</a><span class="delimiter">(</span><a title="String" id="1233879">typeString</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> =
		<a href="Parser.scala.html#326337" title="(str: String, parser: sbt.complete.Parser[sbt.complete.TypeString])Either[String,sbt.complete.TypeString]">parse</a><span class="delimiter">(</span><a href="#1233879" title="String">typeString</a>, <a href="#1233877" title="=&gt; sbt.complete.Parser[sbt.complete.TypeString]">typeStringParser</a><span class="delimiter">)</span> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
			<span class="keyword">case</span> <span title="java.lang.String">Right</span><span class="delimiter">(</span><a title="sbt.complete.TypeString" id="2172654">ts</a><span class="delimiter">)</span> =&gt; <a href="#2172654" title="sbt.complete.TypeString">ts</a>.<a href="#2172564" title="()java.lang.String">toString</a>
			<span class="keyword">case</span> <span title="String">Left</span><span class="delimiter">(</span><a title="String" id="2172656">err</a><span class="delimiter">)</span> =&gt; <a href="#1233879" title="String">typeString</a>
		<span class="delimiter">}</span>

	<span class="comment">/** Makes a fully qualified type name provided by Manifest.toString more readable.
	* The argument should be just a name (like scala.Tuple2) and not a full type (like scala.Tuple2[Int,Boolean])*/</span>
	<span class="keyword">def</span> <a title="(base: String)String" id="1233859">cleanupTypeName</a><span class="delimiter">(</span><a title="String" id="2172588">base</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> =
		<a href="#1233860" title="(base: String)String">dropPrefix</a><span class="delimiter">(</span><a href="#2172588" title="String">base</a><span class="delimiter">)</span>.<span title="(x$1: Char, x$2: Char)java.lang.String">replace</span><span class="delimiter">(</span><span title="Char(\'$\')" class="char">'$'</span>, <span title="Char(\'.\')" class="char">'.'</span><span class="delimiter">)</span>

	<span class="comment">/** Removes prefixes from a fully qualified type name that are unnecessary in the presence of standard imports for an sbt setting. 
	* This does not use the compiler and is therefore a conservative approximation.*/</span>
	<span class="keyword">def</span> <a title="(base: String)String" id="1233860">dropPrefix</a><span class="delimiter">(</span><a title="String" id="2172657">base</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> =
		<span title="String" class="keyword">if</span><span class="delimiter">(</span><a href="#2172657" title="String">base</a>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;sbt.&quot;)">SbtPrefix</span><span class="delimiter">)</span><span class="delimiter">)</span>
			<a href="#2172657" title="String">base</a>.<span title="(x$1: Int)java.lang.String">substring</span><span class="delimiter">(</span><span title="java.lang.String(&quot;sbt.&quot;)">SbtPrefix</span>.<span title="()Int">length</span><span class="delimiter">)</span>
		<span class="keyword">else</span> <span title="String" class="keyword">if</span><span class="delimiter">(</span><a href="#2172657" title="String">base</a>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;scala.collection.&quot;)">CollectionPrefix</span><span class="delimiter">)</span><span class="delimiter">)</span>
		<span class="delimiter">{</span>
			<span class="keyword">val</span> <a title="java.lang.String" id="2172670">simple</a> = <a href="#2172657" title="String">base</a>.<span title="(x$1: Int)java.lang.String">substring</span><span class="delimiter">(</span><span title="java.lang.String(&quot;scala.collection.&quot;)">CollectionPrefix</span>.<span title="()Int">length</span><span class="delimiter">)</span>
			<span title="String" class="keyword">if</span><span class="delimiter">(</span><a href="#1233873" title="(elem: java.lang.String)Boolean">ShortenCollection</a><span class="delimiter">(</span><a href="#2172670" title="java.lang.String">simple</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#2172670" title="java.lang.String">simple</a> <span class="keyword">else</span> <a href="#2172657" title="String">base</a>
		<span class="delimiter">}</span>
		<span class="keyword">else</span> <span title="String" class="keyword">if</span><span class="delimiter">(</span><a href="#2172657" title="String">base</a>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;scala.&quot;)">ScalaPrefix</span><span class="delimiter">)</span><span class="delimiter">)</span>
			<a href="#2172657" title="String">base</a>.<span title="(x$1: Int)java.lang.String">substring</span><span class="delimiter">(</span><span title="java.lang.String(&quot;scala.&quot;)">ScalaPrefix</span>.<span title="()Int">length</span><span class="delimiter">)</span>
		<span class="keyword">else</span> <span title="String" class="keyword">if</span><span class="delimiter">(</span><a href="#2172657" title="String">base</a>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;java.lang.&quot;)">JavaPrefix</span><span class="delimiter">)</span><span class="delimiter">)</span>
			<a href="#2172657" title="String">base</a>.<span title="(x$1: Int)java.lang.String">substring</span><span class="delimiter">(</span><span title="java.lang.String(&quot;java.lang.&quot;)">JavaPrefix</span>.<span title="()Int">length</span><span class="delimiter">)</span>
		<span class="keyword">else</span>
			<a href="#1233875" title="=&gt; scala.collection.immutable.Map[java.lang.String,java.lang.String]">TypeMap</a>.<span title="(key: java.lang.String, default: =&gt; java.lang.String)java.lang.String">getOrElse</span><span class="delimiter">(</span><a href="#2172657" title="String">base</a>, <a href="#2172657" title="String">base</a><span class="delimiter">)</span>

	<span class="keyword">final</span> <span class="keyword">val</span> <a title="java.lang.String(&quot;scala.collection.&quot;)" id="1233861">CollectionPrefix</a> = <span title="java.lang.String(&quot;scala.collection.&quot;)" class="string">&quot;scala.collection.&quot;</span>
	<span class="keyword">final</span> <span class="keyword">val</span> <a title="java.lang.String(&quot;scala.Function&quot;)" id="1233863">FunctionName</a> = <span title="java.lang.String(&quot;scala.Function&quot;)" class="string">&quot;scala.Function&quot;</span>
	<span class="keyword">final</span> <span class="keyword">val</span> <a title="java.lang.String(&quot;scala.Tuple&quot;)" id="1233865">TupleName</a> = <span title="java.lang.String(&quot;scala.Tuple&quot;)" class="string">&quot;scala.Tuple&quot;</span>
	<span class="keyword">final</span> <span class="keyword">val</span> <a title="java.lang.String(&quot;sbt.&quot;)" id="1233867">SbtPrefix</a> = <span title="java.lang.String(&quot;sbt.&quot;)" class="string">&quot;sbt.&quot;</span>
	<span class="keyword">final</span> <span class="keyword">val</span> <a title="java.lang.String(&quot;scala.&quot;)" id="1233869">ScalaPrefix</a> = <span title="java.lang.String(&quot;scala.&quot;)" class="string">&quot;scala.&quot;</span>
	<span class="keyword">final</span> <span class="keyword">val</span> <a title="java.lang.String(&quot;java.lang.&quot;)" id="1233871">JavaPrefix</a> = <span title="java.lang.String(&quot;java.lang.&quot;)" class="string">&quot;java.lang.&quot;</span>
	<span class="comment">/* scala.collection.X -&gt; X */</span>
	<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.lang.String]" id="1233873">ShortenCollection</a> = <span title="(elems: java.lang.String*)scala.collection.immutable.Set[java.lang.String]">Set</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Seq&quot;)" class="string">&quot;Seq&quot;</span>, <span title="java.lang.String(&quot;List&quot;)" class="string">&quot;List&quot;</span>, <span title="java.lang.String(&quot;Set&quot;)" class="string">&quot;Set&quot;</span>, <span title="java.lang.String(&quot;Map&quot;)" class="string">&quot;Map&quot;</span>, <span title="java.lang.String(&quot;Iterable&quot;)" class="string">&quot;Iterable&quot;</span><span class="delimiter">)</span>
	<span class="keyword">val</span> <a title="scala.collection.immutable.Map[java.lang.String,java.lang.String]" id="1233875">TypeMap</a> = <span title="(elems: (java.lang.String, java.lang.String)*)scala.collection.immutable.Map[java.lang.String,java.lang.String]">Map</span><span class="delimiter">(</span>
		<span title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;java.io.File&quot;</span> <span title="(y: java.lang.String)(java.lang.String, java.lang.String)">-&gt;</span> <span title="java.lang.String(&quot;File&quot;)" class="string">&quot;File&quot;</span>,
		<span title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;java.net.URL&quot;</span> <span title="(y: java.lang.String)(java.lang.String, java.lang.String)">-&gt;</span> <span title="java.lang.String(&quot;URL&quot;)" class="string">&quot;URL&quot;</span>,
		<span title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;java.net.URI&quot;</span> <span title="(y: java.lang.String)(java.lang.String, java.lang.String)">-&gt;</span> <span title="java.lang.String(&quot;URI&quot;)" class="string">&quot;URI&quot;</span>
	<span class="delimiter">)</span>

	<span class="comment">/** A Parser that extracts basic structure from the string representation of a type from Manifest.toString.
	* This is rudimentary and essentially only decomposes the string into names and arguments for parameterized types.
	* */</span>
	<span class="keyword">lazy</span> <span class="keyword">val</span> <a title="sbt.complete.Parser[sbt.complete.TypeString]" id="1233878">typeStringParser</a>: <a href="Parser.scala.html#12695" title="sbt.complete.Parser[sbt.complete.TypeString]">Parser</a><span class="delimiter">[</span>TypeString<span class="delimiter">]</span> =
	<span class="delimiter">{</span>
		<span class="keyword">def</span> <a title="(c: Char)Boolean" id="2172705">isFullScalaIDChar</a><span class="delimiter">(</span><a title="Char" id="2172710">c</a>: <span title="Char">Char</span><span class="delimiter">)</span> = <a href="Parsers.scala.html#326238" title="(c: Char)Boolean">isScalaIDChar</a><span class="delimiter">(</span><a href="#2172710" title="Char">c</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <a href="#2172710" title="Char">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'.\')" class="char">'.'</span> <span title="(x: Boolean)Boolean">||</span> <a href="#2172710" title="Char">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'$\')" class="char">'$'</span>
		<span class="keyword">lazy</span> <span class="keyword">val</span> <a title="sbt.complete.Parser[String]" id="2172707">fullScalaID</a> = <a href="Parsers.scala.html#326233" title="(start: sbt.complete.Parser[Char], rep: sbt.complete.Parser[Char])sbt.complete.Parser[String]">identifier</a><span class="delimiter">(</span><a href="Parsers.scala.html#326218" title="=&gt; sbt.complete.Parser[Char]">IDStart</a>, <a href="Parser.scala.html#326332" title="(f: Char =&gt; Boolean, label: String)sbt.complete.Parser[Char]">charClass</a><span class="delimiter">(</span><a href="#2172705" title="(c: Char)Boolean">isFullScalaIDChar</a>, <span title="java.lang.String(&quot;Scala identifier character&quot;)" class="string">&quot;Scala identifier character&quot;</span><span class="delimiter">)</span> <span class="delimiter">)</span>
		<span class="keyword">lazy</span> <span class="keyword">val</span> <a title="sbt.complete.Parser[sbt.complete.TypeString]" id="2172709">tpe</a>: <a href="Parser.scala.html#12695" title="sbt.complete.Parser[sbt.complete.TypeString]">Parser</a><span class="delimiter">[</span>TypeString<span class="delimiter">]</span> =
			<span class="keyword">for</span><span class="delimiter">(</span> <a title="String" id="2172818">id</a> &lt;- <a href="Parser.scala.html#326925" title="(f: String =&gt; sbt.complete.Parser[sbt.complete.TypeString])sbt.complete.Parser[sbt.complete.TypeString]">fullScalaID</a>; <a title="Option[Seq[sbt.complete.TypeString]]" id="2173051">args</a> &lt;- <span class="delimiter">(</span><a href="Parser.scala.html#326323" title="implicit sbt.complete.ParserMain.literalRichCharParser : (c: Char)sbt.complete.RichParser[Char]" class="char">'['</a> <a href="Parser.scala.html#326320" title="(a: sbt.complete.Parser[Seq[sbt.complete.TypeString]])sbt.complete.RichParser[Seq[sbt.complete.TypeString]]">~&gt;</a> <a href="Parsers.scala.html#326294" title="(rep: sbt.complete.Parser[sbt.complete.TypeString], sep: sbt.complete.Parser[_])sbt.complete.Parser[Seq[sbt.complete.TypeString]]">rep1sep</a><span class="delimiter">(</span><a href="#2172708" title="=&gt; sbt.complete.Parser[sbt.complete.TypeString]">tpe</a>, <a href="Parser.scala.html#326333" title="implicit sbt.complete.ParserMain.literal : (ch: Char)sbt.complete.Parser[Char]" class="char">','</a><span class="delimiter">)</span> <a href="Parser.scala.html#326320" title="(a: sbt.complete.Parser[Seq[sbt.complete.TypeString]])sbt.complete.RichParser[Seq[sbt.complete.TypeString]]">&lt;~</a> <a href="Parser.scala.html#326333" title="implicit sbt.complete.ParserMain.literal : (ch: Char)sbt.complete.Parser[Char]" class="char">']'</a><span class="delimiter">)</span>.<a href="Parser.scala.html#326900" title="(f: Option[Seq[sbt.complete.TypeString]] =&gt; sbt.complete.TypeString)sbt.complete.Parser[sbt.complete.TypeString]">?</a><span class="delimiter">)</span> <span class="keyword">yield</span>
				 <span title="sbt.complete.TypeString" class="keyword">new</span> <a href="#12772" title="sbt.complete.TypeString">TypeString</a><span class="delimiter">(</span><a href="#2172818" title="String">id</a>, <a href="#2173051" title="Option[Seq[sbt.complete.TypeString]]">args</a>.<span title="=&gt; List[Seq[sbt.complete.TypeString]]">toList</span>.<span title="(implicit asTraversable: Seq[sbt.complete.TypeString] =&gt; scala.collection.TraversableOnce[sbt.complete.TypeString])List[sbt.complete.TypeString]">flatten</span><span class="delimiter">)</span>
		<a href="#2172708" title="=&gt; sbt.complete.Parser[sbt.complete.TypeString]">tpe</a>
	<span class="delimiter">}</span>
<span class="delimiter">}</span>
        </pre>
    </body>
</html>